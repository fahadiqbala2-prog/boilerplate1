/*! Copyright 2025 Adobe
All Rights Reserved. */
import{jsx as a,jsxs as c,Fragment as b}from"@dropins/tools/preact-jsx-runtime.js";import{classes as N,Slot as F}from"@dropins/tools/lib.js";import{Card as w,Button as x,Header as k,InLineAlert as H,Field as C,Input as y,Skeleton as z,SkeletonRow as p}from"@dropins/tools/components.js";import{useState as v,useCallback as E,useEffect as D}from"@dropins/tools/preact-hooks.js";import{g as I,u as L}from"../chunks/updateCompany.js";import*as s from"@dropins/tools/preact-compat.js";import"@dropins/tools/fetch-graphql.js";import"@dropins/tools/event-bus.js";const S=({company:e,slots:t,showEditForm:n,handleShowEditForm:l})=>{var o,u;if(!e)return a(w,{variant:"secondary",className:"account-company-information-card",children:a("div",{className:"account-company-information-card__wrapper",children:a("div",{className:"account-company-information-card__content",children:a("p",{children:"Company information not available. Please contact your administrator."})})})});const d=[{name:"name",label:"Company Name",value:e.name||""},{name:"email",label:"Email",value:e.email||""},{name:"legal_name",label:"Legal Name",value:e.legal_name||""},{name:"vat_tax_id",label:"VAT/Tax ID",value:e.vat_tax_id||""},{name:"reseller_id",label:"Reseller ID",value:e.reseller_id||""}];return a(w,{variant:"secondary",className:N(["account-company-information-card",["account-company-information-card-short",n]]),children:c("div",{className:"account-company-information-card__wrapper",children:[a("div",{className:"account-company-information-card__actions",children:e.canEdit&&a(x,{type:"button",variant:"tertiary",onClick:l,children:"Edit"})}),a("div",{className:"account-company-information-card__content",children:t!=null&&t.CompanyData?a(F,{name:"CompanyData",slot:t==null?void 0:t.CompanyData,context:{companyData:d}}):c(b,{children:[d.map((i,r)=>{if(!i.value)return null;const m=i.label?`${i.label}: ${i.value}`:i.value;return a("p",{"data-testid":`${i.name}_${r}`,children:m},`${i.name}_${r}`)}),e.legal_address&&c(b,{children:[a("p",{children:a("strong",{children:"Legal Address:"})}),(o=e.legal_address.street)==null?void 0:o.map((i,r)=>a("p",{children:i},r)),c("p",{children:[e.legal_address.city,", ",(u=e.legal_address.region)==null?void 0:u.region," ",e.legal_address.postcode]}),a("p",{children:e.legal_address.countryCode}),e.legal_address.telephone&&c("p",{children:["Phone: ",e.legal_address.telephone]})]})]})})]})})},M=({inLineAlertProps:e,company:t,loading:n=!1,onSubmit:l,onCancel:d})=>{const[o,u]=v({name:(t==null?void 0:t.name)||"",email:(t==null?void 0:t.email)||"",legal_name:(t==null?void 0:t.legal_name)||"",vat_tax_id:(t==null?void 0:t.vat_tax_id)||"",reseller_id:(t==null?void 0:t.reseller_id)||""}),i=async m=>{m.preventDefault(),l&&await l(o)},r=m=>f=>{u(_=>({..._,[m]:f}))};return c(w,{variant:"secondary",className:"account-edit-company-information",children:[a(k,{title:"Edit Company Information",divider:!1,className:"account-edit-company-information__title"}),e!=null&&e.text?a(H,{className:"account-edit-company-information__notification",type:e.type,variant:"secondary",heading:e.text,icon:e.icon,"data-testid":"editCompanyInLineAlert"}):null,c("form",{className:"account-edit-company-information-form",onSubmit:i,children:[a(C,{label:"Company Name",required:!0,children:a(y,{name:"name",type:"text",value:o.name,onValue:r("name"),disabled:n,variant:"primary",size:"medium"})}),a(C,{label:"Email",required:!0,children:a(y,{name:"email",type:"email",value:o.email,onValue:r("email"),disabled:n,variant:"primary",size:"medium"})}),a(C,{label:"Legal Name",children:a(y,{name:"legal_name",type:"text",value:o.legal_name,onValue:r("legal_name"),disabled:n,variant:"primary",size:"medium"})}),a(C,{label:"VAT/Tax ID",children:a(y,{name:"vat_tax_id",type:"text",value:o.vat_tax_id,onValue:r("vat_tax_id"),disabled:n,variant:"primary",size:"medium"})}),a(C,{label:"Reseller ID",children:a(y,{name:"reseller_id",type:"text",value:o.reseller_id,onValue:r("reseller_id"),disabled:n,variant:"primary",size:"medium"})}),c("div",{className:"account-edit-company-information__actions",children:[a(x,{disabled:n,type:"button",variant:"secondary",onClick:d,children:"Cancel"}),a(x,{disabled:n,type:"submit",variant:"primary",children:n?"Saving...":"Save Changes"})]})]})]})},Z=({testId:e,withCard:t=!0})=>{const n=c(z,{rowGap:"medium","data-testid":e,children:[c("div",{className:"company-card-loader__header",children:[a(p,{size:"large",variant:"heading"}),a(p,{size:"small",variant:"row"})]}),c("div",{className:"company-card-loader__content",children:[c("div",{className:"company-card-loader__section",children:[a(p,{size:"medium",variant:"heading"}),a(p,{size:"medium",lines:5,multilineGap:"small"})]}),c("div",{className:"company-card-loader__section",children:[a(p,{size:"medium",variant:"heading"}),a(p,{size:"medium",lines:3,multilineGap:"small"})]})]})]});return t?a(w,{variant:"primary",className:"company-card-loader",children:n}):n},R=({handleSetInLineAlert:e})=>{const[t,n]=v(null),[l,d]=v(!0),[o,u]=v(!1),[i,r]=v(!1),m=E(()=>{I().then(g=>{n(g),d(!1)}).catch(g=>{console.error("Failed to load company:",g),d(!1),e&&e({type:"error",text:"Failed to load company information"})})},[e]);D(()=>{m()},[m]);const f=E(()=>{r(!0),e&&e()},[e]),_=E(()=>{r(!1)},[]),V=E(async g=>{try{u(!0);const h=await L(g);t&&(h.canEdit=t.canEdit,h.customerRole=t.customerRole,h.customerStatus=t.customerStatus),n(h),r(!1),e&&e({type:"success",text:"Company information updated successfully"})}catch(h){console.error("Failed to update company:",h),e&&e({type:"error",text:"Failed to update company information"})}finally{u(!1)}},[t,e]);return{company:t,loading:l,saving:o,showEditForm:i,handleShowEditForm:f,handleHideEditForm:_,handleUpdateCompany:V}},$=e=>s.createElement("svg",{id:"Icon_Warning_Base",width:24,height:24,viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg",...e},s.createElement("g",{clipPath:"url(#clip0_841_1324)"},s.createElement("path",{vectorEffect:"non-scaling-stroke",d:"M11.9949 2.30237L0.802734 21.6977H23.1977L11.9949 2.30237Z",stroke:"currentColor",strokeLinecap:"round",strokeLinejoin:"round"}),s.createElement("path",{vectorEffect:"non-scaling-stroke",d:"M12.4336 10.5504L12.3373 14.4766H11.6632L11.5669 10.5504V9.51273H12.4336V10.5504ZM11.5883 18.2636V17.2687H12.4229V18.2636H11.5883Z",stroke:"currentColor",strokeLinecap:"round",strokeLinejoin:"round"})),s.createElement("defs",null,s.createElement("clipPath",{id:"clip0_841_1324"},s.createElement("rect",{width:24,height:21,fill:"white",transform:"translate(0 1.5)"})))),B=e=>s.createElement("svg",{width:24,height:24,viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg",...e},s.createElement("path",{vectorEffect:"non-scaling-stroke",d:"M0.75 12C0.75 5.78421 5.78421 0.75 12 0.75C18.2158 0.75 23.25 5.78421 23.25 12C23.25 18.2158 18.2158 23.25 12 23.25C5.78421 23.25 0.75 18.2158 0.75 12Z",stroke:"currentColor"}),s.createElement("path",{vectorEffect:"non-scaling-stroke",d:"M6.75 12.762L10.2385 15.75L17.25 9",stroke:"currentColor"})),W=e=>s.createElement("svg",{width:24,height:24,viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg",...e},s.createElement("path",{vectorEffect:"non-scaling-stroke",d:"M0.75 12C0.75 5.78421 5.78421 0.75 12 0.75C18.2158 0.75 23.25 5.78421 23.25 12C23.25 18.2158 18.2158 23.25 12 23.25C5.78421 23.25 0.75 18.2158 0.75 12Z",stroke:"currentColor"}),s.createElement("path",{vectorEffect:"non-scaling-stroke",d:"M11.75 5.88423V4.75H12.25V5.88423L12.0485 13.0713H11.9515L11.75 5.88423ZM11.7994 18.25V16.9868H12.2253V18.25H11.7994Z",stroke:"currentColor"})),j={success:a(B,{}),warning:a($,{}),error:a(W,{})},T=()=>{const[e,t]=v({}),n=E(l=>{if(!(l!=null&&l.type)){t({});return}const d=j[l.type];t({...l,icon:d})},[]);return{inLineAlertProps:e,handleSetInLineAlert:n}},Q=({className:e,withHeader:t=!0,slots:n})=>{const{inLineAlertProps:l,handleSetInLineAlert:d}=T(),{company:o,loading:u,saving:i,showEditForm:r,handleShowEditForm:m,handleHideEditForm:f,handleUpdateCompany:_}=R({handleSetInLineAlert:d});return u?a("div",{"data-testid":"companyInformationLoader",children:a(Z,{withCard:!0})}):c("div",{className:N(["account-company-information",e]),children:[t?a(k,{title:"Company Information",divider:!1,className:"company-information__title"}):null,a(S,{company:o,slots:n,showEditForm:r,handleShowEditForm:m}),r?a(M,{inLineAlertProps:l,company:o,loading:i,onSubmit:_,onCancel:f}):null]})};export{Q as CompanyInformation,Q as default};
//# sourceMappingURL=CompanyInformation.js.map
