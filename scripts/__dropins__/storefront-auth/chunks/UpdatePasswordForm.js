import{jsx as h,Fragment as F,jsxs as U}from"@dropins/tools/preact-jsx-runtime.js";import{useState as V,useCallback as f,useRef as O,useEffect as Z}from"@dropins/tools/preact-hooks.js";import*as m from"@dropins/tools/preact-compat.js";import{memo as y,useCallback as k}from"@dropins/tools/preact-compat.js";import{initReCaptcha as P}from"@dropins/tools/recaptcha.js";import{useText as W}from"@dropins/tools/i18n.js";import{classes as M}from"@dropins/tools/lib.js";import{Field as w,Picker as G,Input as j,InputDate as q,Checkbox as X,TextArea as C,Button as z}from"@dropins/tools/components.js";const me=r=>{if(!r)return null;const t=new FormData(r);if(t&&typeof t.entries=="function"){const l=t.entries();if(l&&typeof l[Symbol.iterator]=="function")return JSON.parse(JSON.stringify(Object.fromEntries(l)))||{}}return{}},Ie=r=>typeof r=="function",B=r=>m.createElement("svg",{id:"Icon_Warning_Base",width:24,height:24,viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg",...r},m.createElement("g",{clipPath:"url(#clip0_841_1324)"},m.createElement("path",{vectorEffect:"non-scaling-stroke",d:"M11.9949 2.30237L0.802734 21.6977H23.1977L11.9949 2.30237Z",stroke:"currentColor",strokeLinecap:"round",strokeLinejoin:"round"}),m.createElement("path",{vectorEffect:"non-scaling-stroke",d:"M12.4336 10.5504L12.3373 14.4766H11.6632L11.5669 10.5504V9.51273H12.4336V10.5504ZM11.5883 18.2636V17.2687H12.4229V18.2636H11.5883Z",stroke:"currentColor",strokeLinecap:"round",strokeLinejoin:"round"})),m.createElement("defs",null,m.createElement("clipPath",{id:"clip0_841_1324"},m.createElement("rect",{width:24,height:21,fill:"white",transform:"translate(0 1.5)"})))),J=r=>m.createElement("svg",{width:24,height:24,viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg",...r},m.createElement("path",{vectorEffect:"non-scaling-stroke",d:"M0.75 12C0.75 5.78421 5.78421 0.75 12 0.75C18.2158 0.75 23.25 5.78421 23.25 12C23.25 18.2158 18.2158 23.25 12 23.25C5.78421 23.25 0.75 18.2158 0.75 12Z",stroke:"currentColor"}),m.createElement("path",{vectorEffect:"non-scaling-stroke",d:"M6.75 12.762L10.2385 15.75L17.25 9",stroke:"currentColor"})),Y=r=>m.createElement("svg",{width:24,height:24,viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg",...r},m.createElement("path",{vectorEffect:"non-scaling-stroke",d:"M0.75 12C0.75 5.78421 5.78421 0.75 12 0.75C18.2158 0.75 23.25 5.78421 23.25 12C23.25 18.2158 18.2158 23.25 12 23.25C5.78421 23.25 0.75 18.2158 0.75 12Z",stroke:"currentColor"}),m.createElement("path",{vectorEffect:"non-scaling-stroke",d:"M11.75 5.88423V4.75H12.25V5.88423L12.0485 13.0713H11.9515L11.75 5.88423ZM11.7994 18.25V16.9868H12.2253V18.25H11.7994Z",stroke:"currentColor"})),K={success:h(J,{}),warning:h(B,{}),error:h(Y,{})},De=()=>{const[r,t]=V({}),l=f(o=>{if(!o||!o.type){t({});return}const c=K[o.type];t({...o,icon:c})},[]);return{inLineAlertProps:r,handleSetInLineAlertProps:l}};var x=(r=>(r.BOOLEAN="BOOLEAN",r.DATE="DATE",r.DATETIME="DATETIME",r.DROPDOWN="DROPDOWN",r.FILE="FILE",r.GALLERY="GALLERY",r.HIDDEN="HIDDEN",r.IMAGE="IMAGE",r.MEDIA_IMAGE="MEDIA_IMAGE",r.MULTILINE="MULTILINE",r.MULTISELECT="MULTISELECT",r.PRICE="PRICE",r.SELECT="SELECT",r.TEXT="TEXT",r.TEXTAREA="TEXTAREA",r.UNDEFINED="UNDEFINED",r.VISUAL="VISUAL",r.WEIGHT="WEIGHT",r.EMPTY="",r))(x||{});const Q=y(({loading:r,values:t,fields:l=[],errors:o,className:c="",onChange:d,onBlur:p,onFocus:E})=>{const s=`${c}__field`,D=k((e,n,a)=>{var i;const A=(i=e.options.find(T=>T.isDefault))==null?void 0:i.value;return h(w,{error:a,className:M([s,`${s}--${e.id}`,[`${s}--${e.id}-hidden`,e.isHidden],e.className]),"data-testid":`${c}--${e.id}`,disabled:r||e.disabled,children:h(G,{name:e.customUpperCode,floatingLabel:`${e.label} ${e.required?"*":""}`,placeholder:e.label,"aria-label":e.label,options:e.options,onBlur:p,handleSelect:d,defaultValue:A??n??e.defaultValue,value:A??n??e.defaultValue})},e.id)},[c,r,s,p,d]),N=k((e,n,a)=>h(w,{error:a,className:M([s,`${s}--${e.id}`,[`${s}--${e.id}-hidden`,e.isHidden],e.className]),"data-testid":`${c}--${e.id}`,disabled:r,children:h(j,{type:"text",name:e.customUpperCode,value:n??e.defaultValue,placeholder:e.label,floatingLabel:`${e.label} ${e.required?"*":""}`,onBlur:p,onChange:d,onFocus:E})},e.id),[c,r,s,p,d,E]),b=k((e,n,a)=>h(w,{error:a,className:M([s,`${s}--${e.id}`,[`${s}--${e.id}-hidden`,e.isHidden],e.className]),"data-testid":`${c}--${e.id}`,disabled:r||e.disabled,children:h(q,{type:"text",name:e.customUpperCode,value:n||e.defaultValue,placeholder:e.label,floatingLabel:`${e.label} ${e.required?"*":""}`,onBlur:p,onChange:d,disabled:r||e.disabled})},e.id),[c,r,s,p,d]),L=k((e,n,a)=>h(w,{error:a,className:M([s,`${s}--${e.id}`,[`${s}--${e.id}-hidden`,e.isHidden],e.className]),"data-testid":`${c}--${e.id}`,disabled:r,children:h(X,{name:e.customUpperCode,checked:n||e.defaultValue,placeholder:e.label,label:`${e.label} ${e.required?"*":""}`,onBlur:p,onChange:d})},e.id),[c,r,s,p,d]),_=k((e,n,a)=>h(w,{error:a,className:M([s,`${s}--${e.id}`,[`${s}--${e.id}-hidden`,e.isHidden],e.className]),"data-testid":`${c}--${e.id}`,disabled:r,children:h(C,{type:"text",name:e.customUpperCode,value:n??e.defaultValue,label:`${e.label} ${e.required?"*":""}`,onBlur:p,onChange:d})},e.id),[c,r,s,p,d]);return l.length?h(F,{children:l.map(e=>{const n=o==null?void 0:o[e.customUpperCode],a=t==null?void 0:t[e.customUpperCode];switch(e.fieldType){case x.TEXT:return e.options.length?D(e,a,n):N(e,a,n);case x.MULTILINE:return N(e,a,n);case x.SELECT:return D(e,a,n);case x.DATE:return b(e,a,n);case x.BOOLEAN:return L(e,a,n);case x.TEXTAREA:return _(e,a,n);default:return null}})}):null}),g=r=>r.reduce((t,{customUpperCode:l,required:o,defaultValue:c})=>(o&&l&&(t.initialData[l]=c||"",t.errorList[l]=""),t),{initialData:{},errorList:{}}),ee=r=>r.reduce((t,l)=>({...t,[l.name]:l.value}),{}),re=r=>/^\d+$/.test(r),te=r=>/^[a-zA-Z0-9\s]+$/.test(r),ae=r=>/^[a-zA-Z0-9]+$/.test(r),ne=r=>/^[a-zA-Z]+$/.test(r),le=r=>/^[a-z0-9,!\#\$%&'\*\+\/=\?\^_`\{\|\}~-]+(\.[a-z0-9,!\#\$%&'\*\+\/=\?\^_`\{\|\}~-]+)*@([a-z0-9-]+\.)+[a-z]{2,}$/i.test(r),oe=r=>/^\d{4}-\d{2}-\d{2}$/.test(r)&&!isNaN(Date.parse(r)),se=(r,t,l)=>{const o=new Date(r).getTime()/1e3;return isNaN(o)||o<0?!1:o>=t&&o<=l},H=r=>new Date(parseInt(r,10)*1e3).toISOString().split("T")[0],ce=r=>/^(https?|ftp):\/\/(([A-Z0-9]([A-Z0-9_-]*[A-Z0-9]|))(\.[A-Z0-9]([A-Z0-9_-]*[A-Z0-9]|))*)(:(\d+))?(\/[A-Z0-9~](([A-Z0-9_~-]|\.)*[A-Z0-9~]|))*\/?(.*)?$/i.test(r),de=(r,t,l)=>{const o=r.length;return o>=t&&o<=l},S=(r,t,l,o)=>{var v,R;const{requiredFieldError:c,lengthTextError:d,numericError:p,alphaNumWithSpacesError:E,alphaNumericError:s,alphaError:D,emailError:N,dateError:b,urlError:L,dateLengthError:_}=l,e=t==null?void 0:t.customUpperCode,n={[e]:""};if(o[e]&&delete o[e],t!=null&&t.required&&!r)return{[e]:c};if(!(t!=null&&t.required)&&!r||!((v=t==null?void 0:t.validateRules)!=null&&v.length))return n;const a=ee(t==null?void 0:t.validateRules),A=a.MIN_TEXT_LENGTH??1,i=a.MAX_TEXT_LENGTH??255,T=a.DATE_RANGE_MIN,I=a.DATE_RANGE_MAX;if(!de(r,+A,+i)&&!(T||I))return{[e]:d.replace("{min}",A).replace("{max}",i)};if(!se(r,+T,+I)&&(T||I))return{[e]:_.replace("{min}",H(T)).replace("{max}",H(I))};const u={numeric:{validate:re,error:p},"alphanum-with-spaces":{validate:te,error:E},alphanumeric:{validate:ae,error:s},alpha:{validate:ne,error:D},email:{validate:le,error:N},date:{validate:oe,error:b},url:{validate:ce,error:L}}[a.INPUT_VALIDATION];return u&&!u.validate(r)&&!((R=o[e])!=null&&R.length)?{[e]:u.error}:n},ue=({fieldsConfig:r,onSubmit:t})=>{const l=W({requiredFieldError:"Auth.FormText.requiredFieldError",lengthTextError:"Auth.FormText.lengthTextError",numericError:"Auth.FormText.numericError",alphaNumWithSpacesError:"Account.FormText.alphaNumWithSpacesError",alphaNumericError:"Auth.FormText.alphaNumericError",alphaError:"Auth.FormText.alphaError",emailError:"Auth.FormText.emailError",dateError:"Auth.FormText.dateError",dateLengthError:"Auth.FormText.dateLengthError",urlError:"Auth.FormText.urlError"}),o=O(null),c=O(!1),[d,p]=V({}),[E,s]=V({}),D=f((e=!1)=>{let n=!0;const a={...E};let A=null;for(const[i,T]of Object.entries(d)){const I=r==null?void 0:r.find(u=>{var v;return(v=u==null?void 0:u.customUpperCode)==null?void 0:v.includes(i)}),$=S(T.toString(),I,l,a);$[i]&&(Object.assign(a,$),n=!1),A||(A=Object.keys(a).find(u=>a[u])||null)}if(e||s(a),A&&o.current&&!e){const i=o.current.elements.namedItem(A);i==null||i.focus()}return n},[E,r,d,l]);Z(()=>{if(r!=null&&r.length){const{initialData:e,errorList:n}=g(r);p(a=>({...e,...a})),s(n)}},[JSON.stringify(r)]);const N=f(async()=>{c.current||(await P(0),c.current=!0)},[]),b=f(e=>{const{name:n,value:a,type:A,checked:i}=e==null?void 0:e.target,T=A==="checkbox"?i:a;p(u=>({...u,[n]:T}));const I=r==null?void 0:r.find(u=>{var v;return(v=u==null?void 0:u.customUpperCode)==null?void 0:v.includes(n)});let $={...E};if(I){const u=S(T.toString(),I,l,$);u&&Object.assign($,u),s($)}},[r,E,l]),L=f(e=>{const{name:n,value:a,type:A,checked:i}=e==null?void 0:e.target,T=A==="checkbox"?i:a,I=r==null?void 0:r.find($=>$.customUpperCode===n);if(I){const $={...E},u=S(T.toString(),I,l,$);u&&Object.assign($,u),s($)}},[E,r,l]),_=f(e=>{e.preventDefault();const n=D();t==null||t(e,n)},[D,t]);return{formData:d,errors:E,formRef:o,handleChange:b,handleBlur:L,handleSubmit:_,handleFocus:N}},Ne=({name:r,loading:t,children:l,className:o="defaultForm",fieldsConfig:c=[],onSubmit:d})=>{const{formData:p,errors:E,formRef:s,handleChange:D,handleBlur:N,handleSubmit:b,handleFocus:L}=ue({onSubmit:d,fieldsConfig:c});return U("form",{className:o,onSubmit:b,name:r,ref:s,onFocus:L,children:[h(Q,{className:o,onFocus:L,fields:c,onChange:D,onBlur:N,errors:E,values:p,loading:t}),l]})},be=({type:r,buttonText:t,variant:l,className:o="",enableLoader:c=!1,onClick:d,style:p,icon:E,...s})=>{const D=f(b=>{d==null||d(b)},[d]);return U(z,{icon:E,style:p,type:r,variant:l,className:M(["auth-button",o,c?"enableLoader":""]),onClick:D,...s,children:[h("span",{className:"auth-button__text",children:t}),c?h("div",{className:"auth-button__wrapper",children:h("span",{className:"auth-button__loader"})}):null]})};export{be as B,Ne as F,Ie as c,me as g,De as u};
