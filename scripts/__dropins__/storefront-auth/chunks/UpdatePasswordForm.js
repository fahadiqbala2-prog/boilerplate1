import{jsx as E,Fragment as Z,jsxs as U}from"@dropins/tools/preact-jsx-runtime.js";import{useState as R,useCallback as L,useRef as H,useEffect as P}from"@dropins/tools/preact-hooks.js";import*as f from"@dropins/tools/preact-compat.js";import{memo as W,useCallback as w}from"@dropins/tools/preact-compat.js";import{initReCaptcha as G}from"@dropins/tools/recaptcha.js";import{useText as j}from"@dropins/tools/i18n.js";import{classes as M}from"@dropins/tools/lib.js";import{Field as k,Picker as q,Input as X,InputDate as C,Checkbox as z,TextArea as B,Button as J}from"@dropins/tools/components.js";const Ie=e=>{if(!e)return null;const t=new FormData(e);if(t&&typeof t.entries=="function"){const n=t.entries();if(n&&typeof n[Symbol.iterator]=="function")return JSON.parse(JSON.stringify(Object.fromEntries(n)))||{}}return{}},Ne=e=>typeof e=="function",Y=e=>f.createElement("svg",{id:"Icon_Warning_Base",width:24,height:24,viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg",...e},f.createElement("g",{clipPath:"url(#clip0_841_1324)"},f.createElement("path",{vectorEffect:"non-scaling-stroke",d:"M11.9949 2.30237L0.802734 21.6977H23.1977L11.9949 2.30237Z",stroke:"currentColor",strokeLinecap:"round",strokeLinejoin:"round"}),f.createElement("path",{vectorEffect:"non-scaling-stroke",d:"M12.4336 10.5504L12.3373 14.4766H11.6632L11.5669 10.5504V9.51273H12.4336V10.5504ZM11.5883 18.2636V17.2687H12.4229V18.2636H11.5883Z",stroke:"currentColor",strokeLinecap:"round",strokeLinejoin:"round"})),f.createElement("defs",null,f.createElement("clipPath",{id:"clip0_841_1324"},f.createElement("rect",{width:24,height:21,fill:"white",transform:"translate(0 1.5)"})))),K=e=>f.createElement("svg",{width:24,height:24,viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg",...e},f.createElement("path",{vectorEffect:"non-scaling-stroke",d:"M0.75 12C0.75 5.78421 5.78421 0.75 12 0.75C18.2158 0.75 23.25 5.78421 23.25 12C23.25 18.2158 18.2158 23.25 12 23.25C5.78421 23.25 0.75 18.2158 0.75 12Z",stroke:"currentColor"}),f.createElement("path",{vectorEffect:"non-scaling-stroke",d:"M6.75 12.762L10.2385 15.75L17.25 9",stroke:"currentColor"})),Q=e=>f.createElement("svg",{width:24,height:24,viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg",...e},f.createElement("path",{vectorEffect:"non-scaling-stroke",d:"M0.75 12C0.75 5.78421 5.78421 0.75 12 0.75C18.2158 0.75 23.25 5.78421 23.25 12C23.25 18.2158 18.2158 23.25 12 23.25C5.78421 23.25 0.75 18.2158 0.75 12Z",stroke:"currentColor"}),f.createElement("path",{vectorEffect:"non-scaling-stroke",d:"M11.75 5.88423V4.75H12.25V5.88423L12.0485 13.0713H11.9515L11.75 5.88423ZM11.7994 18.25V16.9868H12.2253V18.25H11.7994Z",stroke:"currentColor"})),g={success:E(K,{}),warning:E(Y,{}),error:E(Q,{})},me=()=>{const[e,t]=R({}),n=L(o=>{if(!o||!o.type){t({});return}const c=g[o.type];t({...o,icon:c})},[]);return{inLineAlertProps:e,handleSetInLineAlertProps:n}};var v=(e=>(e.BOOLEAN="BOOLEAN",e.DATE="DATE",e.DATETIME="DATETIME",e.DROPDOWN="DROPDOWN",e.FILE="FILE",e.GALLERY="GALLERY",e.HIDDEN="HIDDEN",e.IMAGE="IMAGE",e.MEDIA_IMAGE="MEDIA_IMAGE",e.MULTILINE="MULTILINE",e.MULTISELECT="MULTISELECT",e.PRICE="PRICE",e.SELECT="SELECT",e.TEXT="TEXT",e.TEXTAREA="TEXTAREA",e.UNDEFINED="UNDEFINED",e.VISUAL="VISUAL",e.WEIGHT="WEIGHT",e.EMPTY="",e))(v||{});const ee=W(({loading:e,values:t,fields:n=[],errors:o,className:c="",onChange:d,onBlur:p,onFocus:A})=>{const s=`${c}__field`,$=w((r,l,a)=>{var h;const T=(h=r.options.find(D=>D.isDefault))==null?void 0:h.value;return E(k,{error:a,className:M([s,`${s}--${r.id}`,[`${s}--${r.id}-hidden`,r.isHidden],r.className]),"data-testid":`${c}--${r.id}`,disabled:e||r.disabled,children:E(q,{name:r.customUpperCode,floatingLabel:`${r.label} ${r.required?"*":""}`,placeholder:r.label,"aria-label":r.label,options:r.options,onBlur:p,handleSelect:d,defaultValue:T??l??r.defaultValue,value:T??l??r.defaultValue})},r.id)},[c,e,s,p,d]),N=w((r,l,a)=>E(k,{error:a,className:M([s,`${s}--${r.id}`,[`${s}--${r.id}-hidden`,r.isHidden],r.className]),"data-testid":`${c}--${r.id}`,disabled:e,children:E(X,{type:"text",name:r.customUpperCode,value:l??r.defaultValue,placeholder:r.label,floatingLabel:`${r.label} ${r.required?"*":""}`,onBlur:p,onChange:d,onFocus:A})},r.id),[c,e,s,p,d,A]),m=w((r,l,a)=>E(k,{error:a,className:M([s,`${s}--${r.id}`,[`${s}--${r.id}-hidden`,r.isHidden],r.className]),"data-testid":`${c}--${r.id}`,disabled:e||r.disabled,children:E(C,{type:"text",name:r.customUpperCode,value:l||r.defaultValue,placeholder:r.label,floatingLabel:`${r.label} ${r.required?"*":""}`,onBlur:p,onChange:d,disabled:e||r.disabled})},r.id),[c,e,s,p,d]),x=w((r,l,a)=>E(k,{error:a,className:M([s,`${s}--${r.id}`,[`${s}--${r.id}-hidden`,r.isHidden],r.className]),"data-testid":`${c}--${r.id}`,disabled:e,children:E(z,{name:r.customUpperCode,checked:l||r.defaultValue,placeholder:r.label,label:`${r.label} ${r.required?"*":""}`,onBlur:p,onChange:d})},r.id),[c,e,s,p,d]),_=w((r,l,a)=>E(k,{error:a,className:M([s,`${s}--${r.id}`,[`${s}--${r.id}-hidden`,r.isHidden],r.className]),"data-testid":`${c}--${r.id}`,disabled:e,children:E(B,{type:"text",name:r.customUpperCode,value:l??r.defaultValue,label:`${r.label} ${r.required?"*":""}`,onBlur:p,onChange:d})},r.id),[c,e,s,p,d]);return n.length?E(Z,{children:n.map(r=>{const l=o==null?void 0:o[r.customUpperCode],a=t==null?void 0:t[r.customUpperCode];switch(r.fieldType){case v.TEXT:return r.options.length?$(r,a,l):N(r,a,l);case v.MULTILINE:return N(r,a,l);case v.SELECT:return $(r,a,l);case v.DATE:return m(r,a,l);case v.BOOLEAN:return x(r,a,l);case v.TEXTAREA:return _(r,a,l);default:return null}})}):null}),re=e=>e.reduce((t,{customUpperCode:n,required:o,defaultValue:c})=>(o&&n&&(t.initialData[n]=c||"",t.errorList[n]=""),t),{initialData:{},errorList:{}}),te=e=>e.reduce((t,n)=>({...t,[n.name]:n.value}),{}),ae=e=>/^\d+$/.test(e),ne=e=>/^[a-zA-Z0-9\s]+$/.test(e),oe=e=>/^[a-zA-Z0-9]+$/.test(e),le=e=>/^[a-zA-Z]+$/.test(e),se=e=>/^[a-z0-9,!\#\$%&'\*\+\/=\?\^_`\{\|\}~-]+(\.[a-z0-9,!\#\$%&'\*\+\/=\?\^_`\{\|\}~-]+)*@([a-z0-9-]+\.)+[a-z]{2,}$/i.test(e),ce=e=>/^\d{4}-\d{2}-\d{2}$/.test(e)&&!isNaN(Date.parse(e)),de=(e,t,n)=>{const o=new Date(e).getTime()/1e3;return!(isNaN(o)||o<0||typeof t<"u"&&o<t||typeof n<"u"&&o>n)},S=e=>{if(!e||e.trim()==="")return"";const t=parseInt(e,10);if(isNaN(t)){const c=new Date(e);return isNaN(c.getTime())?"":c.toISOString().split("T")[0]}const n=new Date(t*1e3);return isNaN(n.getTime())?"":n.toISOString().split("T")[0]},ue=e=>/^(https?|ftp):\/\/(([A-Z0-9]([A-Z0-9_-]*[A-Z0-9]|))(\.[A-Z0-9]([A-Z0-9_-]*[A-Z0-9]|))*)(:(\d+))?(\/[A-Z0-9~](([A-Z0-9_~-]|\.)*[A-Z0-9~]|))*\/?(.*)?$/i.test(e),ie=(e,t,n)=>{const o=e.length;return o>=t&&o<=n},O=(e,t,n,o)=>{var y,F;const{requiredFieldError:c,lengthTextError:d,numericError:p,alphaNumWithSpacesError:A,alphaNumericError:s,alphaError:$,emailError:N,dateError:m,urlError:x,dateLengthError:_,dateMaxError:r,dateMinError:l}=n,a=t==null?void 0:t.customUpperCode,T={[a]:""};if(o[a]&&delete o[a],t!=null&&t.required&&!e)return{[a]:c};if(!(t!=null&&t.required)&&!e||!((y=t==null?void 0:t.validateRules)!=null&&y.length))return T;const h=te(t==null?void 0:t.validateRules),D=h.MIN_TEXT_LENGTH??1,I=h.MAX_TEXT_LENGTH??255,i=h.DATE_RANGE_MIN,u=h.DATE_RANGE_MAX;if(!ie(e,+D,+I)&&!(i||u))return{[a]:d.replace("{min}",D).replace("{max}",I)};if(!de(e,+i,+u)&&(i||u)){if(typeof i>"u"&&u)return{[a]:r.replace("{max}",S(u))};if(typeof i>"u"&&i)return{[a]:l.replace("{min}",S(i))};if(i&&i)return{[a]:_.replace("{min}",S(i)).replace("{max}",S(u))}}const V={numeric:{validate:ae,error:p},"alphanum-with-spaces":{validate:ne,error:A},alphanumeric:{validate:oe,error:s},alpha:{validate:le,error:$},email:{validate:se,error:N},date:{validate:ce,error:m},url:{validate:ue,error:x}}[h.INPUT_VALIDATION];return V&&!V.validate(e)&&!((F=o[a])!=null&&F.length)?{[a]:V.error}:T},pe=({fieldsConfig:e,onSubmit:t})=>{const n=j({requiredFieldError:"Auth.FormText.requiredFieldError",lengthTextError:"Auth.FormText.lengthTextError",numericError:"Auth.FormText.numericError",alphaNumWithSpacesError:"Account.FormText.alphaNumWithSpacesError",alphaNumericError:"Auth.FormText.alphaNumericError",alphaError:"Auth.FormText.alphaError",emailError:"Auth.FormText.emailError",dateError:"Auth.FormText.dateError",dateLengthError:"Auth.FormText.dateLengthError",dateMaxError:"Auth.FormText.dateMaxError",dateMinError:"Auth.FormText.dateMinError",urlError:"Auth.FormText.urlError"}),o=H(null),c=H(!1),[d,p]=R({}),[A,s]=R({}),$=L((r=!1)=>{let l=!0;const a={...A};let T=null;for(const[h,D]of Object.entries(d)){const I=e==null?void 0:e.find(u=>{var b;return(b=u==null?void 0:u.customUpperCode)==null?void 0:b.includes(h)}),i=O(D.toString(),I,n,a);i[h]&&(Object.assign(a,i),l=!1),T||(T=Object.keys(a).find(u=>a[u])||null)}if(r||s(a),T&&o.current&&!r){const h=o.current.elements.namedItem(T);h==null||h.focus()}return l},[A,e,d,n]);P(()=>{if(e!=null&&e.length){const{initialData:r,errorList:l}=re(e);p(a=>({...r,...a})),s(l)}},[JSON.stringify(e)]);const N=L(async()=>{c.current||(await G(0),c.current=!0)},[]),m=L(r=>{const{name:l,value:a,type:T,checked:h}=r==null?void 0:r.target,D=T==="checkbox"?h:a;p(u=>({...u,[l]:D}));const I=e==null?void 0:e.find(u=>{var b;return(b=u==null?void 0:u.customUpperCode)==null?void 0:b.includes(l)});let i={...A};if(I){const u=O(D.toString(),I,n,i);u&&Object.assign(i,u),s(i)}},[e,A,n]),x=L(r=>{const{name:l,value:a,type:T,checked:h}=r==null?void 0:r.target,D=T==="checkbox"?h:a,I=e==null?void 0:e.find(i=>i.customUpperCode===l);if(I){const i={...A},u=O(D.toString(),I,n,i);u&&Object.assign(i,u),s(i)}},[A,e,n]),_=L(r=>{r.preventDefault();const l=$();t==null||t(r,l)},[$,t]);return{formData:d,errors:A,formRef:o,handleChange:m,handleBlur:x,handleSubmit:_,handleFocus:N}},xe=({name:e,loading:t,children:n,className:o="defaultForm",fieldsConfig:c=[],onSubmit:d})=>{const{formData:p,errors:A,formRef:s,handleChange:$,handleBlur:N,handleSubmit:m,handleFocus:x}=pe({onSubmit:d,fieldsConfig:c});return U("form",{className:o,onSubmit:m,name:e,ref:s,onFocus:x,children:[E(ee,{className:o,onFocus:x,fields:c,onChange:$,onBlur:N,errors:A,values:p,loading:t}),n]})},be=({type:e,buttonText:t,variant:n,className:o="",enableLoader:c=!1,onClick:d,style:p,icon:A,...s})=>{const $=L(m=>{d==null||d(m)},[d]);return U(J,{icon:A,style:p,type:e,variant:n,className:M(["auth-button",o,c?"enableLoader":""]),onClick:$,...s,children:[E("span",{className:"auth-button__text",children:t}),c?E("div",{className:"auth-button__wrapper",children:E("span",{className:"auth-button__loader"})}):null]})};export{be as B,xe as F,Ne as c,Ie as g,me as u};
