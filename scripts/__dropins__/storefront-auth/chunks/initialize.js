/*! Copyright 2025 Adobe
All Rights Reserved. */
import{Initializer as u}from"@dropins/tools/lib.js";import{events as h}from"@dropins/tools/event-bus.js";import{setFetchGraphQlHeader as f,fetchGraphQl as d}from"@dropins/tools/fetch-graphql.js";const l=async()=>{var n,o;const e=((o=(n=document.cookie.split("; ").find(t=>t.startsWith("auth_dropin_user_token=")))==null?void 0:n.split("=")[1])==null?void 0:o.trim())||null;if(!e)return;f("Authorization",`Bearer ${e}`);const i=()=>{["auth_dropin_user_token","auth_dropin_firstname"].forEach(t=>{document.cookie=`${t}=; expires=Thu, 01 Jan 1970 00:00:00 UTC; path=/;`}),h.emit("authenticated",!1),window.location.reload()};await d("query VALIDATE_TOKEN{ customerCart { id } }").then(t=>{var a;(a=t.errors)!=null&&a.find(c=>{var r;return((r=c.extensions)==null?void 0:r.category)==="graphql-authentication"})&&i()})},s=new u({init:async e=>{const i={authHeaderConfig:{header:"Authorization",tokenPrefix:"Bearer"}};s.config.setConfig({...i,...e}),await l()},listeners:()=>[]}),g=s.config;export{l as a,g as c,s as i};
