/*! Copyright 2025 Adobe
All Rights Reserved. */
import{Initializer as f}from"@dropins/tools/lib.js";import{events as c}from"@dropins/tools/event-bus.js";import{a as h,d as u,C as o}from"./getStoreConfig.js";import{a as d,f as m,r as g}from"./network-error.js";function l(e){const n=h(o.auth_dropin_user_token);n&&(d(e.header,`${e.tokenPrefix} ${n}`),m("query VALIDATE_TOKEN{ customerCart { id } }").then(t=>{var r;(r=t.errors)!=null&&r.find(s=>{var i;return((i=s.extensions)==null?void 0:i.category)==="graphql-authentication"})&&(u(o.auth_dropin_user_token),g(e.header),c.emit("authenticated",!1))}))}const a=new f({init:async e=>{const t={...{authHeaderConfig:{header:"Authorization",tokenPrefix:"Bearer"}},...e};a.config.setConfig(t),l(t.authHeaderConfig)},listeners:()=>[]}),y=a.config;export{y as c,a as i};
