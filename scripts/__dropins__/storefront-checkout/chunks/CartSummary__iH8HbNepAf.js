import{d as Q,u as ee,H as te,S as j}from"./usePreselectedFields__C2LJAdglEo.js";import{useState as re,useEffect as ae,useCallback as ne}from"@dropins/tools/preact-hooks.js";import{i as ie,T as ce,n as se}from"./countries__kOBkhT14HN.js";import"@dropins/tools/event-bus.js";import{S as T,a as x}from"./BillToShippingAddress__DaEGMXF6uc.js";import{jsx as e,jsxs as l,Fragment as E}from"@dropins/tools/preact-jsx-runtime.js";import{P as oe,C as U}from"./ProgressSpinner__Bqh6pootSA.js";import{S as le}from"./cart-item__CslQ7p973r.js";import*as N from"@dropins/tools/preact-compat.js";import{useState as V,useMemo as Z,useContext as de,useCallback as K}from"@dropins/tools/preact-compat.js";import{a as me}from"./UIProvider__krDvY5_bDA.js";import{Icon as I}from"@dropins/tools/components/Icon.js";import{c as s,L as F,T as M,u as L}from"./preact-i18n.esm__AesnfYdPmV.js";import{V as w}from"./vcomponent__B-EAiH6JFM.js";import{B as ue}from"./Button__Dyj88ihZKB.js";import{g as pe}from"./image-params-keymap__Bk3U4q-hHX.js";import{P}from"./Price__DZvul-osZQ.js";import{D as q}from"./Divider__8lDmXqHqNY.js";import{e as _e}from"./transform-shipping-methods__Cf4nSDpLmb.js";const G={medium:768,large:1024,xlarge:1366,xxlarge:1920},he=(a,t)=>{const[n,r]=a.split("?"),i=new URLSearchParams(r),o=pe();let d={};return o&&Object.keys(o).length>0&&t?d=Object.entries(t).reduce((c,[u,_])=>{const p=o[u];return p&&(c[p]=_),c},{}):d={auto:"webp",quality:80,crop:!1,fit:"cover",...t},Object.entries(d).forEach(([c,u])=>{u!=null&&i.set(c,String(u))}),`${n}?${i.toString()}`},fe=(a,t)=>{if(!a||!(t!=null&&t.width))return;const n=r=>he(a,{...r});return Object.entries(G).map(([,r])=>{const i=t.width*r/G.xxlarge;return`${n({...t,width:i})} ${r}w`}).join(`,
`)};function ke(a){window.location.href=a}const $=a=>N.createElement("svg",{id:"Icon_Add_Base","data-name":"Icon \\u2013 Add \\u2013 Base",xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",...a},N.createElement("g",{id:"Large"},N.createElement("rect",{id:"Placement_area","data-name":"Placement area",width:24,height:24,fill:"#fff",opacity:0}),N.createElement("g",{id:"Add_icon","data-name":"Add icon",transform:"translate(9.734 9.737)"},N.createElement("line",{vectorEffect:"non-scaling-stroke",id:"Line_579","data-name":"Line 579",y2:12.7,transform:"translate(2.216 -4.087)",fill:"none",stroke:"currentColor"}),N.createElement("line",{vectorEffect:"non-scaling-stroke",id:"Line_580","data-name":"Line 580",x2:12.7,transform:"translate(-4.079 2.263)",fill:"none",stroke:"currentColor"})))),z=a=>N.createElement("svg",{width:24,height:24,viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg",...a},N.createElement("path",{d:"M17.3332 11.75H6.6665",strokeWidth:1.5,strokeLinecap:"square",strokeLinejoin:"round",vectorEffect:"non-scaling-stroke",fill:"none",stroke:"currentColor"})),ge=a=>N.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",...a},N.createElement("path",{d:"M1 5H23",stroke:"black",strokeWidth:1.5,strokeMiterlimit:10}),N.createElement("path",{d:"M17.3674 22H6.63446C5.67952 22 4.88992 21.2688 4.8379 20.3338L4 5H20L19.1621 20.3338C19.1119 21.2688 18.3223 22 17.3655 22H17.3674Z",stroke:"black",strokeWidth:1.5,strokeMiterlimit:10}),N.createElement("path",{d:"M9.87189 2H14.1281C14.6085 2 15 2.39766 15 2.88889V5H9V2.88889C9 2.39912 9.39006 2 9.87189 2Z",stroke:"black",strokeWidth:1.5,strokeMiterlimit:10}),N.createElement("path",{d:"M8.87402 8.58057L9.39348 17.682",stroke:"black",strokeWidth:1.5,strokeMiterlimit:10}),N.createElement("path",{d:"M14.6673 8.58057L14.146 17.682",stroke:"black",strokeWidth:1.5,strokeMiterlimit:10})),ye=({name:a,value:t="1",className:n,disabled:r,error:i,success:o,min:d,max:c,onValue:u,onUpdateError:_,size:p="medium",...y})=>{const[m,h]=re(Number(t)),f=Number(d),S=Number(c);ae(()=>{h(Number(t))},[t]);const C=ne(Q(async g=>{if(u)try{await u(g)}catch(k){_&&_(k)}},200),[u,_]),v=g=>{let k=g;g<f&&(k=f),g>S&&(k=S),C(k),h(k)};return e("div",{className:s(["dropin-incrementer",`dropin-incrementer--${p}`,n]),children:l("div",{className:s(["dropin-incrementer__content",`dropin-incrementer__content--${p}`,["dropin-incrementer__content--error",i],["dropin-incrementer__content--success",o],["dropin-incrementer__content--disabled",r]]),children:[e("div",{className:s(["dropin-incrementer__button-container",["dropin-incrementer__button-container--disabled",r]]),children:e(F,{children:e("button",{type:"button",className:s(["dropin-incrementer__decrease-button",["dropin-incrementer__decrease-button--disabled",r]]),onClick:()=>v(m-1),disabled:r||m<f+1,"aria-label":e(M,{id:"Dropin.Incrementer.decreaseLabel"}),children:e(I,{source:z,size:"16",stroke:"1",viewBox:"4 2 20 20",className:"dropin-incrementer__down"})})})}),e("input",{className:"dropin-incrementer__input",max:c,min:d,step:1,type:"number",name:a,value:m,disabled:r,onChange:g=>{const k=g.currentTarget.value;k!==""&&v(Number(k))},...y}),e("div",{className:s(["dropin-incrementer__button-container",["dropin-incrementer__button-container--disabled",r]]),children:e(F,{children:e("button",{type:"button",className:s(["dropin-incrementer__increase-button",["dropin-incrementer__increase-button--disabled",r]]),onClick:()=>v(m+1),disabled:r||m>S-1,"aria-label":e(M,{id:"Dropin.Incrementer.increaseLabel"}),children:e(I,{source:$,size:"16",stroke:"1",viewBox:"4 2 20 20",className:"dropin-incrementer__add"})})})})]})})},Ne=({className:a,src:t,params:n,loading:r="lazy",srcSet:i,onLoad:o,...d})=>{const[c,u]=V(!1),_=Z(()=>{if(i)return i;if(!(!t||!n))return fe(t,{...n})},[n,t,i]),p=y=>{u(!0),o==null||o(y)};return e("img",{...d,className:s(["dropin-image",["dropin-image--loaded",c],a]),loading:r,onLoad:p,src:t,srcSet:_})},J=({className:a,children:t,title:n,secondaryText:r,actionIconPosition:i="left",iconOpen:o=$,iconClose:d=z,iconLeft:c=$,showIconLeft:u=!1,renderContentWhenClosed:_=!0,onStateChange:p,...y})=>{const[m,h]=V(!1),f=k=>{k.stopImmediatePropagation();const O=!m;h(O),p==null||p(O)},S=L(`Dropin.Accordion.${m?"close":"open"}.label`).label,C=e(I,{source:o,size:"24",onClick:f,onKeyPress:f,className:"dropin-accordion-section__open-icon"}),v=e(I,{source:d,size:"24",onClick:f,onKeyPress:f,className:"dropin-accordion-section__close-icon"}),g=e(I,{source:c,size:"24"});return l("div",{...y,className:s(["dropin-accordion-section",a]),children:[l("div",{className:"dropin-accordion-section__heading",children:[e("div",{className:"dropin-accordion-section__flex",onClick:f,onKeyPress:f,role:"button","aria-label":`${S} ${n}`,tabIndex:0,children:l("div",{className:"dropin-accordion-section__title-container",children:[i==="left"&&(m?v:C),u&&g,e("h3",{className:"dropin-accordion-section__title",children:n})]})}),l("div",{className:"dropin-accordion-section__secondary-text-container",children:[r&&e("h4",{className:"dropin-accordion-section__secondary-text",children:r}),i==="right"&&(m?v:C)]})]}),e("div",{className:"dropin-accordion-section__content-container",style:{display:m?"grid":"none"},children:(m||_&&!m)&&t})]})},ve=({className:a,children:t,actionIconPosition:n="left",iconOpen:r=$,iconClose:i=z,...o})=>{const d=e(q,{variant:"secondary"}),c=u=>l(E,{children:[e(J,{...u.props,actionIconPosition:n,iconOpen:r,iconClose:i}),d]});return e("div",{...o,className:s(["dropin-accordion",a]),children:[d,...(Array.isArray(t)?t:[t]).map(c)]})},be=({className:a,children:t,ariaLabel:n,image:r,title:i,price:o,taxIncluded:d=!1,taxExcluded:c=!1,total:u,totalExcludingTax:_,sku:p,configurations:y,warning:m,alert:h,quantity:f=1,description:S,loading:C=!1,updating:v=!1,onQuantity:g,onRemove:k,...O})=>{var B,W;const{locale:H}=de(me),b=L({each:"Dropin.CartItem.each.label",quantity:"Dropin.CartItem.quantity.label",remove:"Dropin.CartItem.remove.label",removeDefault:"Dropin.CartItem.removeDefault.label",taxIncluded:"Dropin.CartItem.taxIncluded.label",taxExcluded:"Dropin.CartItem.taxExcluded.label",updating:"Dropin.CartItem.updating.label",updatingDefault:"Dropin.ProgressSpinner.updating.label"});return C?e(D,{}):l("div",{...O,className:s(["dropin-cart-item",["dropin-cart-item--updating",v],a]),children:[v&&e(oe,{className:s(["dropin-cart-item__spinner"]),ariaLabel:n?(B=b.updating)==null?void 0:B.replace("{product}",n):b.updatingDefault}),l("div",{className:"dropin-cart-item__wrapper",children:[e(w,{node:r,className:s(["dropin-cart-item__image"])}),e(w,{node:i,className:s(["dropin-cart-item__title",["dropin-cart-item__title--edit",!!g||!!k]])}),S&&e(w,{node:S,className:s(["dropin-cart-item__description"])}),e(w,{node:p,className:s(["dropin-cart-item__sku"])}),y&&e("ul",{className:s(["dropin-cart-item__configurations"]),children:Object.entries(y).map(([A,R])=>l("li",{className:s(["dropin-cart-item__configurations__item"]),children:[A,":"," ",e("strong",{className:s(["dropin-cart-item__configurations__item__value"]),children:R})]},A))}),l("span",{className:s(["dropin-cart-item__price"]),children:[!g&&l("span",{className:"dropin-cart-item__price__quantity",children:[f.toLocaleString(H)," x"," "]}),e(w,{node:o,role:"text"}),f>1&&l(E,{children:[" ",b.each]}),d&&l("span",{"data-testid":"tax-message",className:"dropin-cart-item__price-tax-message",children:[" ",b.taxIncluded]}),c&&l("span",{"data-testid":"tax-message",className:"dropin-cart-item__price-tax-message",children:[" ",b.taxExcluded]})]}),l("div",{className:s(["dropin-cart-item__quantity",["dropin-cart-item__quantity--edit",!!g]]),children:[g?e(ye,{className:s(["dropin-cart-item__quantity__incrementer"]),value:f,min:1,onValue:A=>g==null?void 0:g(Number(A)),name:"quantity","aria-label":b.quantity,disabled:v}):l("span",{className:s(["dropin-cart-item__quantity__value"]),children:[b.quantity,":"," ",e("strong",{className:"dropin-cart-item__quantity__number",children:Number(f).toLocaleString(H)})]}),m&&e(w,{node:m,className:s(["dropin-cart-item__warning","dropin-cart-item__warning--quantity"])}),h&&e(w,{node:h,className:s(["dropin-cart-item__alert","dropin-cart-item__alert--quantity"])})]}),m&&e(w,{node:m,className:s(["dropin-cart-item__warning"])}),h&&e(w,{node:h,className:s(["dropin-cart-item__alert"])}),l("div",{className:s(["dropin-cart-item__total",["dropin-cart-item__total--edit",!!k]]),children:[e("div",{className:"dropin-cart-item__row-total",children:e(w,{node:u,role:"text"})}),d&&l("span",{"data-testid":"tax-message",className:s(["dropin-cart-item__total-tax-message"]),children:[" ",b.taxIncluded]}),c&&e("div",{className:"dropin-cart-item__total-tax-excluded",children:l("span",{"data-testid":"tax-message",className:s(["dropin-cart-item__total-tax-excluded-message"]),children:[_&&e(w,{node:_,role:"text"})," ",b.taxExcluded]})})]})]}),k&&e(ue,{className:s(["dropin-cart-item__remove"]),variant:"tertiary",onClick:()=>k==null?void 0:k(),icon:e(I,{source:ge,size:"24",stroke:"2",viewBox:"0 0 24 24","aria-label":n?(W=b.remove)==null?void 0:W.replace("{product}",n):b.removeDefault}),disabled:v})]})},D=()=>e("div",{className:"dropin-cart-item dropin-cart-item-skeleton",children:l(T,{className:"dropin-cart-item__skeleton dropin-cart-item__wrapper",children:[e("div",{className:"dropin-cart-item__image",children:e(x,{className:"dropin-cart-item__skeleton__item"})}),e("div",{className:"dropin-cart-item__title",children:e(x,{className:"dropin-cart-item__skeleton__item"})}),e("div",{className:"dropin-cart-item__sku",children:e(x,{className:"dropin-cart-item__skeleton__item"})}),e("div",{className:"dropin-cart-item__price",children:e(x,{className:"dropin-cart-item__skeleton__item"})}),e("div",{className:"dropin-cart-item__quantity",children:e(x,{className:"dropin-cart-item__skeleton__item"})}),e("div",{className:"dropin-cart-item__total",children:e(x,{className:"dropin-cart-item__skeleton__item"})})]})}),we=()=>e(U,{children:l(T,{"data-testid":"cart-summary-skeleton",className:"checkout-cart-summary-skeleton",style:{gridTemplateColumns:"1fr"},children:[e(x,{variant:"heading",fullWidth:!0,size:"medium"}),e(D,{}),e(D,{}),e(D,{}),e(D,{}),e(D,{}),e(x,{size:"medium",fullWidth:!0})]})}),Se=()=>e(T,{"data-testid":"cart-summary-skeleton",className:"checkout-mobile-cart-summary-skeleton",style:{gridTemplateColumns:"1fr"},children:e(x,{fullWidth:!0,size:"xlarge"})}),X=({type:a,onClick:t,children:n})=>l(E,{children:[e(q,{className:"checkout-cart-summary__divider-bottom",variant:"primary"}),e("button",{"data-testid":`action-${a}`,className:"checkout-cart-summary__action",onClick:t,children:n})]}),xe=({title:a,isLoading:t,totalQuantity:n,routeCart:r,items:i,taxIncluded:o,action:d})=>e(E,{children:t?e(Se,{}):e(ve,{actionIconPosition:"left",children:l(J,{title:`${a} (${n})`,secondaryText:(r==null?void 0:r())&&e("a",{href:r==null?void 0:r(),rel:"noreferrer",children:e(M,{id:"Checkout.CartSummary.editCart"})}),children:[i==null?void 0:i.map(c=>e(Y,{item:c,taxIncluded:o},c==null?void 0:c.uid)),d]})})}),Ie=({title:a,isLoading:t,totalQuantity:n,routeCart:r,items:i,action:o,taxIncluded:d})=>e(E,{children:t?e(we,{}):l(U,{children:[l("div",{className:"checkout-cart-summary__heading",children:[l(te,{level:2,className:"checkout-cart-summary__title",children:[a," (",n,")"]}),(r==null?void 0:r())&&e("a",{className:"checkout-cart-summary__edit",href:r==null?void 0:r(),rel:"noreferrer",children:e(M,{id:"Checkout.CartSummary.editCart"})})]}),e(q,{className:"checkout-cart-summary__divider-top",variant:"primary"}),e("div",{className:"checkout-cart-summary__items",children:i==null?void 0:i.map(c=>e(Y,{item:c,taxIncluded:d},c==null?void 0:c.uid))}),o]})}),Ce=({className:a,...t})=>{const n=L("Checkout.CartSummary.title").title,r=ee();return e("div",{className:s(["checkout-cart-summary",a]),children:r==="small"?e(xe,{title:n,...t}):e(Ie,{title:n,...t})})},Y=({className:a,item:t,taxIncluded:n=!1})=>{var p,y;const r=L({Sender:"Checkout.CartSummary.GiftCard.sender",Recipient:"Checkout.CartSummary.GiftCard.recipient",Message:"Checkout.CartSummary.GiftCard.message",Download:"Checkout.CartSummary.Downloadable.download",OutOfStockAlert:"Checkout.OutOfStock.alert",..."links"in t&&t.links?{Files:e(M,{id:"Checkout.CartSummary.Downloadable.files",plural:t.links.length,fields:{count:t.links.length}})}:{}});let i=t.regularPrice,o=t.total;n&&(i=t.priceInclTax,o=t.totalInclTax);const d={..."customizableOptions"in t?t.customizableOptions:{},..."configurableOptions"in t?t.configurableOptions:{},..."links"in t&&t.links?{[r.Files]:t.links.join(", ")}:{},..."senderName"in t&&t.senderName?{[r.Sender]:t.senderName}:{},..."recipientName"in t&&t.recipientName?{[r.Recipient]:t.recipientName}:{},..."senderEmail"in t&&"senderName"in t&&t.senderName&&t.senderEmail?{[r.Sender]:`${t.senderName} (${t.senderEmail})`}:{},..."recipientEmail"in t&&"recipientName"in t&&t.recipientName&&t.recipientEmail?{[r.Recipient]:`${t.recipientName} (${t.recipientEmail})`}:{},..."message"in t&&t.message&&t.message!=""?{[r.Message]:c(t.message,60)}:{}};function c(m,h){return m.length>h?`${m.slice(0,h)}...`:m}const u=t.stockStatus===le.OutOfStock?l("span",{"data-testid":"checkout-cart-item-alert",children:[e(I,{source:j,size:"16"}),r.OutOfStockAlert]}):void 0,_=!u&&t.onlyXLeftInStock?l("span",{"data-testid":"checkout-cart-item-low-inventory",children:[e(I,{source:j,size:"16"}),e(M,{id:"Checkout.OutOfStock.lowInventory",plural:t.onlyXLeftInStock,fields:{count:t.onlyXLeftInStock}})]}):void 0;return e("div",{className:s(["checkout-cart-summary-item",a]),children:e(be,{"data-testid":"cart-summary-item",taxIncluded:n,title:e("div",{"data-testid":"product-name",children:t.name}),sku:e("div",{children:t.sku}),quantity:t.quantity,image:e(Ne,{src:((p=t.image)==null?void 0:p.src)??"",alt:(y=t.image)==null?void 0:y.alt,loading:"lazy",width:"80",height:"80",params:{width:80}}),warning:_,alert:u,configurations:d,price:e(P,{amount:t.regularPrice.value,currency:i.currency,weight:"normal"}),total:l(E,{children:[e(P,{amount:t.regularPrice.value*t.quantity,currency:i.currency,variant:t.discounted?"strikethrough":"default"}),t.discounted&&e(P,{amount:o.value,currency:o.currency,sale:!0})]})},t.uid)})},De=5,Me={canDisplayMoreItems:!1,hasHiddenItems:!1,isLoading:!0,isTaxIncluded:!1,totalQuantity:0,visibleItems:[]};function Ee(a){const{config:t}=ie(),n=t===void 0,r=_e.value.data;if(n||r===void 0)return Me;const{cartSummaryMaxItems:o,cartSummaryTotalDisplay:d,taxCartDisplay:c}=t,u=d===ce.Quantity,_=c.shoppingCartDisplayPrice===se.IncludingTax,{items:p,totalQty:y}=r,m=u?y:p.length,h=a?o:Math.min(o,De),f=p.length>h,S=p.slice(0,h);return{canDisplayMoreItems:f&&!a&&h!=o,hasHiddenItems:f,isLoading:!1,isTaxIncluded:_,totalQuantity:m,visibleItems:S}}const Ze=({routeCart:a,...t})=>{const[n,r]=V(!1),i=L({ViewAll:"Checkout.CartSummary.viewAll",ViewMore:"Checkout.CartSummary.viewMore"}),{canDisplayMoreItems:o,hasHiddenItems:d,isLoading:c,isTaxIncluded:u,visibleItems:_,totalQuantity:p}=Ee(n),y=K(()=>{r(!0)},[]),m=K(()=>{a&&ke(a())},[a]),h=Z(()=>{if(d){if(o)return e(X,{type:"view-more",onClick:y,children:i.ViewMore});if(a)return e(X,{type:"view-all",onClick:m,children:i.ViewAll})}},[d,o,y,i.ViewMore,i.ViewAll,m,a]);return e(Ce,{...t,action:h,taxIncluded:u,isLoading:c,items:_,routeCart:a,totalQuantity:p})};export{Ze as C,Ee as u};
//# sourceMappingURL=CartSummary__iH8HbNepAf.js.map
