import"@dropins/tools/event-bus.js";import{e as f}from"./transform-shipping-methods__Cf4nSDpLmb.js";import{u as A}from"./countries__kOBkhT14HN.js";import{i as v}from"./IsBillToShippingSignal__Bk6AE4B7-o.js";import{s as I}from"./setBillingAddress__B-nDRlph1U.js";import{S as B,a as y}from"./BillToShippingAddress__DaEGMXF6uc.js";import{jsxs as w,jsx as o}from"@dropins/tools/preact-jsx-runtime.js";import*as g from"@dropins/tools/preact-compat.js";import{useState as S,useRef as N,useEffect as E}from"@dropins/tools/preact-compat.js";import{Icon as T}from"@dropins/tools/components/Icon.js";import{c as d,u as $}from"./preact-i18n.esm__AesnfYdPmV.js";const P=i=>g.createElement("svg",{id:"Icon_Check_Base","data-name":"Icon \\u2013 Check \\u2013 Base",xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",...i},g.createElement("g",{id:"Large"},g.createElement("rect",{id:"Placement_area","data-name":"Placement area",width:24,height:24,fill:"#fff",opacity:0}),g.createElement("g",{id:"Check_icon","data-name":"Check icon",transform:"translate(303.874 1434.583)"},g.createElement("path",{vectorEffect:"non-scaling-stroke",id:"Path_884137","data-name":"Path 884137",d:"M148,494.611l4.248,4.244,8.538-8.522",transform:"translate(-446.265 -1917.177)",fill:"none",stroke:"currentColor"})))),j=({name:i,value:t,size:n="medium",disabled:s=!1,error:e=!1,label:l="",description:u="",className:h,checked:p,...c})=>{const[r,_]=S(p===void 0?!1:p),a=N(null),m=k=>{var b;(b=c.onChange)==null||b.call(c,k),_(k.currentTarget.checked)},x=k=>{var b;k.key===" "&&(k.preventDefault(),(b=a==null?void 0:a.current)==null||b.click())};return w("label",{className:d(["dropin-checkbox",["dropin-checkbox--disabled",s]]),children:[o("input",{ref:a,name:i,value:t,type:"checkbox",disabled:s,className:d(["dropin-checkbox__checkbox",["dropin-checkbox__checkbox--error",e],h]),...c,onChange:m,checked:r}),o("span",{"aria-checked":r?"true":"false","aria-labelledby":`${i}-label`,"aria-describedby":`${i}-description`,className:d(["dropin-checkbox__box",["dropin-checkbox__box--error",e],["dropin-checkbox__box--disabled",s]]),role:"checkbox",tabIndex:s?-1:0,onKeyDown:x,children:o(T,{className:d(["dropin-checkbox__checkmark"]),source:P,size:"16",stroke:"3"})}),o("div",{id:`${i}-label`,className:d(["dropin-checkbox__label",`dropin-checkbox__label--${n}`,["dropin-checkbox__label--disabled",s]]),children:l}),o("div",{}),o("div",{id:`${i}-description`,role:"note",className:d(["dropin-checkbox__description",`dropin-checkbox__description--${n}`,["dropin-checkbox__description--disabled",s]]),children:u})]})},z=({className:i,isInitialized:t=!0,checked:n=!0,...s})=>{const e=$({title:"Checkout.BillToShippingAddress.title"});return t?o("div",{className:d(["checkout-bill-to-shipping-address",i]),children:o(j,{"data-testid":"bill-to-shipping-checkbox",className:"checkout-bill-to-shipping-address__checkbox",checked:n,name:"checkout-bill-to-shipping-address__checkbox",label:e.title,...s})}):o(O,{})},O=()=>o(B,{className:"bill-to-shipping-address__skeleton",children:o(y,{variant:"row",size:"small"})}),C="is_bill_to_shipping_address";function F(i,t,n){const s=i[n],e=t[n];return s===void 0&&e===void 0||s===null&&e===null?!0:typeof s=="object"&&typeof e=="object"?JSON.stringify(s)===JSON.stringify(e):s===e}function H(i,t,n){return!t&&!n?!0:!t||!n?!1:i.every(s=>{const e=s.code;return F(t,n,e)})}const K=({isBillToShipping:i})=>{var p;const[t,n]=S(!1),{fields:s}=A(),e=f.value.data,l=!!e,u=e==null?void 0:e.billingAddress,h=(p=e==null?void 0:e.shippingAddresses)==null?void 0:p[0];return E(()=>{if(!s)return;const c=localStorage.getItem(C);if(!t&&c){n(!0),i.value={checked:c==="true",setByUser:!1};return}if(!t&&l){n(!0);const r=H(s,u,h);i.value={checked:e!=null&&e.billingAddress?r:i.value.checked,setByUser:!1}}},[u,e==null?void 0:e.billingAddress,s,l,i,t,h]),{isInitialized:t}},W=({children:i,...t})=>{const{data:n}=f.value,s=(n==null?void 0:n.id)||"",e=v.value.checked,{isInitialized:l}=K({isBillToShipping:v});return o(z,{...t,checked:e,isInitialized:l,onChange:h=>{var a;const c=h.target.checked,r=f.value.data,_=!!((a=r==null?void 0:r.shippingAddresses)!=null&&a[0]);if(v.value={checked:c,setByUser:!0},localStorage.setItem(C,c.toString()),l&&c&&_){const m=new AbortController;return I({signal:m.signal,cartId:s,input:{same_as_shipping:!0}}).catch(x=>{console.error(x)}),()=>{m.abort()}}},disabled:f.value.pending})};export{W as B,C as a,H as c};
//# sourceMappingURL=BillToShippingAddress__CfMeosbiqF.js.map
