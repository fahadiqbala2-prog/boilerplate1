import{events as pe}from"@dropins/tools/event-bus.js";import{r as x,e as te}from"./transform-shipping-methods__Cf4nSDpLmb.js";import{o as G,V as L,u as he,p as ge,i as fe,q as ve}from"./countries__kOBkhT14HN.js";import{b as K,a as w,A as z,e as _e,D as X,g as Fe,M as Q,c as ke}from"./estimateShippingMethods__aExd3KlX7Z.js";import{useCallback as P,useRef as ne,useState as H,useEffect as V,useMemo as Ie}from"@dropins/tools/preact-hooks.js";import{c as E,T as re,u as Ce}from"./preact-i18n.esm__AesnfYdPmV.js";import{S as we,a as M}from"./BillToShippingAddress__DaEGMXF6uc.js";import{jsxs as A,jsx as s,Fragment as B}from"@dropins/tools/preact-jsx-runtime.js";import{V as S}from"./vcomponent__B-EAiH6JFM.js";import{createElement as Ee}from"@dropins/tools/preact.js";import{Icon as j}from"@dropins/tools/components/Icon.js";import*as R from"@dropins/tools/preact-compat.js";import{useState as U,useEffect as W,forwardRef as ye,useRef as $e,useImperativeHandle as Ne}from"@dropins/tools/preact-compat.js";const oe=e=>{const t=new FormData(e),n=Object.fromEntries(t);return Object.entries(n).reduce((a,[i])=>{const o=e.elements[i];return o!=null&&o.validationMessage?{...a,[i]:o.validationMessage}:{...a}},{})},be=(e,t)=>{let n;return function(...r){clearTimeout(n),n=setTimeout(()=>e.apply(this,r),t)}},O={firstname:"given-name",lastname:"family-name",company:"organization",country:"country",region:"address-level1",city:"address-level2",postcode:"postal-code",telephone:"tel",street:"address-line1",email:"email",middlename:"additional-name",prefix:"honorific-prefix",suffix:"honorific-suffix"};function ae(e){return Object.keys(e).length===0&&e.constructor===Object}const Me=e=>(e==null?void 0:e.label)&&(e==null?void 0:e.value),Se=e=>e?e.filter(Me).map(t=>({text:t.label,value:t.value})):[],Ae=e=>e.map(t=>{var r;const n=((r=t==null?void 0:t.id)==null?void 0:r.toString())||t.code;return{text:t.name,value:n}}),xe=e=>e?e.map(t=>({text:t.label,value:t.value})):[];function Le({fields:e,address:t,setAddress:n,addressType:r,errors:a,config:i,availableCountries:o,availableRegions:c,onSelection:m,onChange:u,onBlur:d,onInvalid:_}){const g=()=>{n(l=>({...l,[w.Region]:"",[w.RegionId]:""}))},f=l=>{n(F=>({...F,[w.RegionId]:l}))};return e.map(l=>{var $;let F=l.is_required,I,h=l.frontend_input,p=[],b,v,C=!1;if(h==="MULTILINE"?(I=K(l.code,t),b=K(l.code,a)):(I=t[l.code],b=a[l.code]||""),l.code!==w.Region&&l.code!==w.Country&&(p=Se(l.options)),l.code===w.Country&&(p=xe(o),r===z.SHIPPING?(x.value.country=I,v=k=>{const y=k.target,{value:N}=y;N&&Z({country_code:N}),m(k),g()}):v=m),l.code===w.RegionId&&r===z.SHIPPING&&(x.value.selectedRegionId=I),l.code===w.Region){if(r===x.value.addressType&&(C=x.value.pending),F=i.countriesWithRequiredRegion.includes(t==null?void 0:t.country_id),p=Ae(c),!F&&!i.displayStateIfOptional&&(h=G.Undefined),h=p.length>0?G.Select:G.Text,h==="SELECT")r===z.SHIPPING?(x.value.selectedRegion=I,v=k=>{const N=k.target.value;Z({country_code:x.value.country,region_id:N}),m(k),f(N)}):v=k=>{m(k);const N=k.target.value;f(N)};else if(h==="TEXT"&&r===z.SHIPPING){x.value.selectedRegion=I;const k=u;u=y=>{const N=y.target,{value:D}=N;x.value.country&&Z({country_code:x.value.country,region_name:D}),k(y)}}I=p.length>0?(($=p.find(k=>k.value===I))==null?void 0:$.value)||"":I}return l.code===w.PostCode&&(F=!i.countriesWithOptionalZipCode.includes(t==null?void 0:t.country_id)),{...l,is_required:F,frontend_input:h,addressType:r,className:`checkout-address-form__${l.code}`,value:I,options:p,error:b,onChange:u,onBlur:d,onInvalid:_,handleSelect:v,disabled:C}})}let ee;function Z(e){var i;const t=te.value.data,n=!!t,r=(i=t==null?void 0:t.shippingAddresses)==null?void 0:i[0],a=r==null?void 0:r.availableShippingMethods;n&&!a&&(clearTimeout(ee),ee=setTimeout(()=>{_e({cartId:t.id,criteria:e})},X))}const Re=e=>R.createElement("svg",{width:24,height:24,viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg",...e},R.createElement("path",{d:"M7.74512 9.87701L12.0001 14.132L16.2551 9.87701",stroke:"currentColor",strokeWidth:1.5,strokeLinecap:"square",strokeLinejoin:"round"})),De=e=>R.createElement("svg",{width:24,height:24,viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg",...e},R.createElement("path",{vectorEffect:"non-scaling-stroke",d:"M0.75 12C0.75 5.78421 5.78421 0.75 12 0.75C18.2158 0.75 23.25 5.78421 23.25 12C23.25 18.2158 18.2158 23.25 12 23.25C5.78421 23.25 0.75 18.2158 0.75 12Z",stroke:"currentColor"}),R.createElement("path",{vectorEffect:"non-scaling-stroke",d:"M6.75 12.762L10.2385 15.75L17.25 9",stroke:"currentColor"})),Te=e=>R.createElement("svg",{width:24,height:24,viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg",...e},R.createElement("path",{vectorEffect:"non-scaling-stroke",d:"M0.75 12C0.75 5.78421 5.78421 0.75 12 0.75C18.2158 0.75 23.25 5.78421 23.25 12C23.25 18.2158 18.2158 23.25 12 23.25C5.78421 23.25 0.75 18.2158 0.75 12Z",stroke:"currentColor"}),R.createElement("path",{vectorEffect:"non-scaling-stroke",d:"M11.75 5.88423V4.75H12.25V5.88423L12.0485 13.0713H11.9515L11.75 5.88423ZM11.7994 18.25V16.9868H12.2253V18.25H11.7994Z",stroke:"currentColor"})),se=({name:e,value:t,variant:n="primary",className:r,disabled:a,error:i,floatingLabel:o,onValue:c,onUpdateError:m,size:u="medium",icon:d,maxLength:_,success:g,...f})=>{const l=(f==null?void 0:f.id)||e||`dropin-input-${Math.random().toString(36)}`,F=P(be(async h=>{if(c)try{await c(h)}catch(p){m&&m(p)}},200),[c,m]),I=h=>{const p=h.target;F(p.value.trim())};return A("div",{className:E(["dropin-input-container",`dropin-input-container--${n}`,["dropin-input-container--floating",!!o],["dropin-input-container--disabled",a]]),children:[d&&s(S,{node:d,className:E(["dropin-input__field-icon--left",d.props.className])}),A("div",{className:"dropin-input-label-container",children:[s("input",{id:l,onChange:I,type:"text",maxLength:_,name:e,value:t,...f,className:E(["dropin-input",`dropin-input--${u}`,`dropin-input--${n}`,["dropin-input--error",!!i],["dropin-input--success",!!g],["dropin-input--disabled",a],["dropin-input--floating",!!o],["dropin-input--icon-left",!!d],r]),disabled:a}),o&&s("label",{htmlFor:l,className:E([["dropin-input__label--floating",!!o],["dropin-input__label--floating--icon-left",!!d],["dropin-input__label--floating--error",!!i]]),children:o})]}),i&&s("div",{className:E(["dropin-input__field-icon--right","dropin-input__field-icon--error"]),children:s(j,{source:Te,size:"16",stroke:"2",className:"dropin-input--warning-icon",viewBox:"-1 -1 26 26"})}),g&&s("div",{className:E(["dropin-input__field-icon--right","dropin-input__field-icon--success"]),children:s(j,{source:De,size:"16",stroke:"2",className:"dropin-input--success-icon",viewBox:"-1 -1 26 26"})})]})},ze=({name:e,value:t=null,options:n,variant:r="primary",floatingLabel:a,size:i="medium",handleSelect:o=()=>{},disabled:c=!1,error:m=!1,placeholder:u,defaultOption:d,icon:_,className:g,...f})=>{var $;const l=(f==null?void 0:f.id)||e||`dropin-picker-${Math.random().toString(36)}`,F=n==null?void 0:n.find(k=>!k.disabled),[I,h]=U({value:t,text:(d==null?void 0:d.text)||u||(F==null?void 0:F.text),icon:_});W(()=>{const k=n==null?void 0:n.find(y=>y.value===t);h(k??{value:(d==null?void 0:d.value)||(u||a?null:F==null?void 0:F.value),text:(d==null?void 0:d.text)||u||(F==null?void 0:F.text),icon:_})},[t,n,u,_,d,a]);const p=k=>{const{options:y,value:N}=k.target;for(const D of y)D.selected&&(h({value:N,text:D.text,icon:_}),o(k))},b=n==null?void 0:n.map(k=>{const{value:y,text:N,disabled:D}=k,q=y===I.value;return s("option",{value:y,selected:q,disabled:D,className:E(["dropin-picker__option"]),children:N},y)}),v=ne(null),C=!(($=v.current)!=null&&$.selected)||!!d;return A("div",{className:E([g,"dropin-picker",`dropin-picker__${i}`,["dropin-picker__floating",!!a],["dropin-picker__selected",C],["dropin-picker__error",m],["dropin-picker__disabled",c],["dropin-picker__icon",_]]),children:[_&&s(_.type,{..._.props,className:"dropin-picker__icon--placeholder"}),A("select",{id:l,className:E(["dropin-picker__select",`dropin-picker__select--${r}`,`dropin-picker__select--${i}`,["dropin-picker__select--floating",!!a]]),name:e,"aria-label":e,disabled:c,onChange:p,...f,children:[!d&&(a||u)&&s("option",{value:"",ref:v,className:E(["dropin-picker__option dropin-picker__placeholder"]),children:a??u},t),b]}),s(j,{source:Re,size:"24",stroke:"2",className:"dropin-picker__chevronDown"}),a&&C&&s("label",{htmlFor:l,className:E(["dropin-picker__floatingLabel",!!a]),children:a})]})},Y=({className:e,label:t,error:n,hint:r,success:a,size:i="medium",disabled:o=!1,children:c,...m})=>{var _;const u=((_=c==null?void 0:c.props)==null?void 0:_.id)??`dropin-field-${Math.random().toString(36)}`,d=c&&typeof c.type!="string"?c.type:null;return A("div",{...m,className:E(["dropin-field",e]),children:[t&&s("label",{className:E(["dropin-field__label",["dropin-field__label--disabled",o],`dropin-field__label--${i}`]),htmlFor:u,children:t}),s("div",{className:E(["dropin-field__content"]),children:d&&c&&Ee(d,{...c.props,id:u,key:c.key,disabled:o,size:i,error:!!n,success:!!a&&!n})}),s("div",{className:E(["dropin-field__hint",[`dropin-field__hint--${i}`,i],["dropin-field__hint--error",!!n],["dropin-field__hint--success",!!a&&!n],["dropin-field__hint--disabled",!!o]]),children:n||a||r})]})},Ve=()=>{const e=()=>window.innerWidth>=1920?"xxlarge":window.innerWidth>=1366?"xlarge":window.innerWidth>=1024?"large":window.innerWidth>=768?"medium":"small",[t,n]=H(e());return V(()=>{let r;const a=()=>{r&&clearTimeout(r),r=setTimeout(()=>n(e()),50)};return window.addEventListener("resize",a),()=>{window.removeEventListener("resize",a),r&&clearTimeout(r)}},[]),t},ie=({children:e,className:t})=>Ve()==="small"?s(B,{children:e}):s("div",{className:t,children:e}),Pe=({sections:e})=>s(ie,{className:"checkout__aside",children:A(B,{children:[s(S,{node:e.orderSummary}),s(S,{node:e.cartSummary})]})}),Be=({billingAddress:e,billToShippingAddress:t,login:n,paymentMethods:r,placeOrder:a,shippingAddress:i,shippingMethods:o})=>A(B,{children:[s(S,{node:n}),i&&s(S,{node:i}),t&&s(S,{node:t}),o&&s(S,{node:o}),s(S,{node:r}),s(S,{node:e}),s(S,{node:a})]}),He=({outOfStock:e,sections:t})=>s(ie,{className:"checkout__main",children:A(B,{children:[s(ue,{level:1,className:"checkout-title",children:s(re,{id:"Checkout.title"})}),e&&s(S,{className:"checkout-outOfStock",node:e}),t&&s(Be,{...t})]})}),ce=e=>{const{banner:t,className:n,children:r,...a}=e;return A("div",{className:E(["checkout",n]),...a,children:[t&&s(S,{className:"checkout__banner",node:t}),s("div",{className:"checkout__content",children:r})]})};ce.Main=He;ce.Aside=Pe;const Ue=e=>{const{id:t,addressType:n,className:r,code:a,value:i,default_value:o}=e;return s("input",{className:r,id:`${n}-${t||a}`,name:a,type:"hidden",value:i??o},a)},We=e=>{const{addressType:t,className:n,code:r,error:a,id:i,onBlur:o,onChange:c,onInvalid:m,validate_rules:u,value:d}=e,_=le(u),g=i||r;return s(Y,{disabled:e.disabled,error:a,children:s(se,{"aria-label":e.label,autocomplete:O[r]||"off",className:n,floatingLabel:`${e.label} ${e.is_required?"*":""}`,id:`${t}-${g}`,onBlur:o,onChange:c,onInvalid:m,placeholder:e.label,required:e.is_required||!1,type:"text",name:r,value:d??void 0,..._})})},qe=e=>{const{addressType:t,className:n,code:r,disabled:a,error:i,id:o,is_required:c,label:m,multiline_count:u,onBlur:d,onChange:_,onInvalid:g,validate_rules:f,value:l}=e,F=u??0,I=o||r,h=le(f);return s(B,{children:Array.from(Array(F).keys()).map(p=>s(Y,{disabled:a,error:(i==null?void 0:i[p])||"",className:"dropin-field--multiline",children:s(se,{id:`${t}-${I}-${p}`,className:n,floatingLabel:`${m} ${p!=0?p:""} ${c&&p===0?"*":""}`,autocomplete:p===0?O[r]:"off","aria-label":m,placeholder:`${m} ${p!=0?p:""}`,type:"text",required:c&&p===0,onChange:_,onBlur:d,onInvalid:g,name:`${r}-${p}`,value:(l==null?void 0:l[p])||void 0,...h})},`${r}-${p}`))})},Ge=e=>{const{addressType:t,className:n,code:r,disabled:a,error:i,handleSelect:o,id:c,is_required:m,label:u,onBlur:d,onInvalid:_,options:g,value:f}=e,l=c||r,F=o?{handleSelect:o}:{};return s(Y,{disabled:a,error:i,children:s(ze,{id:`${t}-${l}`,className:n,name:r,floatingLabel:`${u} ${m?"*":""}`,required:m,placeholder:u,"aria-label":u,options:g,value:f,autocomplete:O[r]||"off",onBlur:d,onInvalid:_,...F},r)})},Ze=e=>{switch(e.frontend_input){case"BOOLEAN":case"DATE":case"DATETIME":case"FILE":case"GALLERY":case"IMAGE":case"MEDIA_IMAGE":case"MULTISELECT":case"PRICE":case"TEXTAREA":case"UNDEFINED":case"WEIGHT":return null;case"HIDDEN":return Ue(e);case"TEXT":return We(e);case"MULTILINE":return qe(e);case"SELECT":return Ge(e);default:throw new Error(`Unknown field type: ${e.frontend_input}`)}},le=e=>e.reduce((t,n)=>{switch(n.name){case L.DateRangeMax:return{...t,max:n.value};case L.DateRangeMin:return{...t,min:n.value};case L.FileExtensions:return{...t,accept:n.value};case L.InputValidation:return{...t,pattern:je(n.value)};case L.MaxFileSize:case L.MaxImageHeight:case L.MaxImageWidth:return t;case L.MaxTextLength:return{...t,maxLength:n.value};case L.MinTextLength:return{...t,minLength:n.value};default:throw new Error(`Unknown rule: ${n.name}`)}},{}),T={alpha:/^[a-zA-Z]+$/,alphanumeric:/^[a-zA-Z0-9]+$/,"alphanumeric-w-space":/^[a-zA-Z0-9 ]+$/,"alphanum-with-spaces":/^[a-zA-Z0-9 ]+$/,email:/^([a-z0-9,!#$%&'*+/=?^_`{|}~-]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])+(\.([a-z0-9,!#$%&'*+/=?^_`{|}~-]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])+)*@([a-z0-9-]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])+(\.([a-z0-9-]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])+)*\.(([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF]){2,})$/i,numeric:/^[0-9]+$/,url:/^((([A-Za-z]{3,9}:(?:\/\/)?)(?:[-;:&=+$,\w]+@)?[A-Za-z0-9.-]+|(?:www\.|[-;:&=+$,\w]+@)[A-Za-z0-9.-]+)((?:\/[+~%/.\w\-_]*)?\??(?:[-+=&;%@.\w_]*)#?(?:[.!/\\\w]*))?)$/},je=e=>{switch(e){case"alpha":return T.alpha.source;case"alphanumeric":return T.alphanumeric.source;case"alphanumeric-w-space":return T["alphanumeric-w-space"].source;case"alphanum-with-spaces":return T["alphanum-with-spaces"].source;case"url":return T.url.source;case"numeric":return T.numeric.source;case"email":return T.email.source;default:throw new Error(`Unknown validation type: ${e}`)}},Xe=({className:e,name:t,headingId:n,formRef:r,fields:a,...i})=>A("div",{...i,className:E(["checkout-fields-form",e]),children:[s(ue,{level:2,children:s(re,{id:n}),className:"checkout-fields-form__title"}),s("form",{name:t,ref:r,className:E(["checkout-fields-form__form",e]),noValidate:!0,children:a.sort((o,c)=>o.sort_order-c.sort_order).map(Ze)})]}),Oe=e=>A(we,{...e,children:[s(M,{variant:"heading",size:"medium"}),s(M,{variant:"empty",size:"medium"}),s(M,{size:"large"}),s(M,{size:"large"}),s(M,{size:"large",fullWidth:!0}),s(M,{size:"large",fullWidth:!0,lines:3}),s(M,{size:"large"}),s(M,{size:"large"}),s(M,{size:"large"}),s(M,{size:"large"}),s(M,{size:"large"}),s(M,{size:"large"}),s(M,{size:"large"})]}),ue=({className:e,children:t,level:n=2})=>{const r=n>=1&&n<=6?`h${n}`:"h2";return s(r,{className:e,children:t})};function Ye(e){const[t,n]=U({});return W(()=>{e&&n(r=>({...r,country_id:e}))},[e]),{defaultValues:t}}function Je({country:e,addressType:t}){const[n,r]=U([]);return W(()=>{if(!e){r([]);return}Fe(e,t).then(a=>{r(a||[])}).catch(a=>{console.error(a)})},[r,e,t]),{availableRegions:n}}function Ke({shouldAutoFillForm:e,addressType:t,setAddress:n,fields:r}){const[a,i]=U(!1),o=te.value.data;W(()=>{var I;if(a||!(o&&r))return;i(!0);const m=t===z.SHIPPING?o==null?void 0:o.shippingAddresses:o==null?void 0:o.billingAddress;if(!(Array.isArray(m)?m.length>0:!!m)||e&&!e())return;const _=h=>{if(!r)return!1;const p=r.find(b=>b.code===h);return p?p.frontend_input==="MULTILINE":!1},g=Array.isArray(m)?m[0]:m;if(!g)return;const f={[w.City]:g.city,[w.Company]:g.company||"",[w.Country]:g.country.value,[w.FirstName]:g.firstName,[w.LastName]:g.lastName,[w.PostCode]:g.postCode||"",[w.Telephone]:g.telephone||"",[w.Vat]:g.vatId||""},l=g.region;if(l){const h=(I=l==null?void 0:l.id)==null?void 0:I.toString();h?(f[w.Region]=h,f[w.RegionId]=h):f[w.Region]=l.code}g!=null&&g.street&&g.street.length>0&&g.street.forEach((h,p)=>{f[`${w.Street}${Q}${p}`]=h}),((g==null?void 0:g.customAttributes)||[]).forEach(h=>{_(h.code)?h.value.split(ke).forEach((b,v)=>{f[`${h.code}${Q}${v}`]=b}):f[h.code]=h.value}),n(f)},[n,e,t,o,r,a])}const Ft=ye(({name:e,preselectedFields:t,addressType:n,headingId:r,saveAddressHandler:a,children:i,shouldAutoFillForm:o,...c},m)=>{const{fields:u}=he(),{countries:d}=ge(),_=d===void 0,g=u===void 0,{config:f}=fe(),l=f===void 0,{defaultValues:F}=Ye(f==null?void 0:f.defaultCountry),{preselection:I}=st({fields:u,preselectedFields:t}),h=$e(null),{address:p,setAddress:b,onSelection:v,errors:C,onChange:$,onInvalid:k,onBlur:y}=ot({formRef:h,type:n,defaultValues:F,preselection:I,saveAddressHandler:a}),{availableRegions:N}=Je({country:p.country_id,addressType:n});if(Ne(m,()=>({triggerSaveAddress:de=>{if(!h.current)return;const me=oe(h.current);if(ae(me))return a({signal:de,address:p})}})),Ke({shouldAutoFillForm:o,addressType:n,setAddress:b,fields:u}),g||_||l)return s(Oe,{"data-testid":`${n}-skeleton`});const q=Le({fields:u,address:p,setAddress:b,addressType:n,errors:C,config:f,availableCountries:d,availableRegions:N,onSelection:v,onChange:$,onBlur:y,onInvalid:k}),J={[z.SHIPPING]:"shipping",[z.BILLING]:"billing"};return s(Xe,{...c,"data-testid":`${J[n]}-form`,name:e,className:`checkout-${J[n]}-form`,headingId:r,formRef:h,fields:q})});function Qe(e){const{backupService:t}=ve(),[n,r]=H(null);V(()=>{const o=t.restore(e);o&&r(o)},[e,t]),V(()=>{const o=pe.on("checkout/order",()=>{t.remove(e)});return()=>{o==null||o.off()}},[e,t]);const a=P(o=>setTimeout(()=>{t.backup(e,o)},X),[e,t]),i=P(()=>{t.remove(e)},[e,t]);return{addressBackup:n,backup:a,removeBackup:i}}const et={badInput:"aria-label",patternMismatch:"aria-label",rangeOverflow:"max",rangeUnderflow:"min",tooLong:"maxlength",tooShort:"minlength",typeMismatch:"aria-label",valueMissing:"aria-label"},tt=["badInput","patternMismatch","rangeOverflow","rangeUnderflow","tooLong","tooShort","typeMismatch","valueMissing"],nt=e=>{const[t,n]=H({}),r=P(a=>{const{name:i,validity:o,validationMessage:c}=a;let m=o.valid?"":c;tt.forEach(u=>{if(!o[u])return;const d=e[u];if(!d)return;const _=et[u];m=d.replace("{field}",a.getAttribute(_)||"")}),n(u=>({...u,[i]:m}))},[e]);return{errors:t,validateFormElement:r}},rt=e=>{const t=e.current;if(!t)return!1;const n=oe(t);return ae(n)},ot=({formRef:e,type:t,defaultValues:n={},preselection:r={},saveAddressHandler:a})=>{const i=Ce({badInput:"Checkout.AddressForm.Validity.badInput",patternMismatch:"Checkout.AddressForm.Validity.patternMismatch",rangeUnderflow:"Checkout.AddressForm.Validity.rangeUnderflow",tooLong:"Checkout.AddressForm.Validity.tooLong",tooShort:"Checkout.AddressForm.Validity.tooShort",typeMismatch:"Checkout.AddressForm.Validity.typeMismatch",valueMissing:"Checkout.AddressForm.Validity.valueMissing"}),o=ne(!1),[c,m]=H({}),{addressBackup:u,backup:d,removeBackup:_}=Qe(t),{errors:g,validateFormElement:f}=nt(i),l=P(v=>{o.current=!1,a(v).then(()=>{_()}).catch(C=>{o.current=!0,console.error("Saving address form failed:",C)})},[_,a]),F=(v,C)=>{m($=>({...$,[v]:C})),o.current=!0},I=v=>{const C=v.target,{name:$,value:k}=C;F($,k),f(C)},h=v=>{const C=v.target;f(C)},p=v=>{const C=v.target,{name:$,value:k}=C;F($,k),f(C)},b=v=>{v.target.checkValidity()};return V(()=>{m(v=>({...n,...r,...u,...v}))},[n,r,u]),V(()=>{if(!o.current)return;const v=d(c);return()=>{clearTimeout(v)}},[c,d]),V(()=>{if(!o.current||!rt(e))return;const v=new AbortController,C=v.signal,$=setTimeout(()=>{l({signal:C,address:c})},X);return()=>{clearTimeout($),v.abort()}},[c,e,l]),{address:c,setAddress:m,errors:g,onChange:I,onSelection:p,onBlur:b,onInvalid:h}},at={countryCode:"country_id",region:"region",postCode:"postcode"};function st({fields:e,preselectedFields:t}){return{preselection:Ie(()=>!(!!e&&e.length>0)||!!!t?null:Object.keys(t).reduce((i,o)=>{const c=at[o];return!c||!e.some(u=>u.code===c)?i:{...i,[c]:t[o]}},{}),[e,t])}}export{Ft as A,ce as C,Y as F,ue as H,se as I,Te as S,be as d,Ve as u};
//# sourceMappingURL=usePreselectedFields__C2LJAdglEo.js.map
