{"version":3,"file":"guestOrderByToken__BHggZXExSv.js","sources":["../../src/api/errors/errors.ts","../../src/api/fetch-graphql/fetch-graphql.ts","../../src/api/guestOrder/graphql/guestOrder.graphql.ts","../../src/api/guestOrder/guestOrder.ts","../../src/api/guestOrderByToken/graphql/guestOrderByToken.graphql.ts","../../src/api/guestOrderByToken/guestOrderByToken.ts"],"sourcesContent":["import { FetchQueryError } from '@adobe/fetch-graphql';\n\nexport class FetchError extends Error {\n  constructor(reasons: FetchQueryError) {\n    super(reasons.map((e: any) => e.message).join(' '));\n    this.name = 'FetchError';\n  }\n}\n\nexport class MissingArgument extends Error {\n  constructor(argument: string) {\n    super(`Missing argument: ${argument}`);\n  }\n}\n\nexport class OrderNotFound extends Error {\n  constructor() {\n    super('Order not found');\n  }\n}\n","import { FetchGraphQL } from '@adobe/fetch-graphql';\n\nexport const {\n  setEndpoint,\n  setFetchGraphQlHeader,\n  removeFetchGraphQlHeader,\n  setFetchGraphQlHeaders,\n  fetchGraphQl,\n  getConfig,\n} = new FetchGraphQL().getMethods();\n","export const GUEST_ORDER_FRAGMENT = /* GraphQL */ `\n    fragment guestOrderData on CustomerOrder {\n      number\n      status\n      email\n      shipping_method\n      payment_methods {\n        name\n        type\n      }\n      total {\n        subtotal {\n          currency\n          value\n        }\n        total_tax {\n          currency\n          value\n        }\n        total_shipping {\n          currency\n          value\n        }\n        grand_total {\n          currency\n          value\n        }\n      }\n      billing_address {\n        firstname\n        lastname\n        street\n        city\n        postcode\n        telephone\n        country_code\n        region\n        region_id\n      }\n      shipping_address {\n        firstname\n        lastname\n        street\n        city\n        postcode\n        telephone\n        country_code\n        region\n        region_id\n      }\n      items {\n        __typename\n        id\n        quantity_ordered\n        product_sale_price {\n          value\n          currency\n        }\n        product {\n          name\n          sku\n          thumbnail {\n            label\n            url \n          }\n          price_range {\n            maximum_price {\n              regular_price {\n                currency\n                value\n              }\n            }\n          }\n        }\n        selected_options {\n          label\n          value\n        }\n        \n        ... on GiftCardOrderItem {\n          gift_card {\n            recipient_name\n            recipient_email\n            sender_name\n            sender_email\n            message\n          }\n        }\n      }\n    }\n`;\n\nexport const guestOrderQuery = /* GraphQL */ `\n  query guestOrder($number: String!, $email: String!, $postcode: String!) {\n    guestOrder(input: { number: $number, email: $email, postcode: $postcode }) {\n      ...guestOrderData\n    }\n  }\n  ${GUEST_ORDER_FRAGMENT}\n`;\n","import { fetchGraphQl } from '@/order-confirmation/api';\nimport {\n  FetchError,\n  OrderNotFound,\n} from '@/order-confirmation/api/errors';\nimport { guestOrderQuery } from '@/order-confirmation/api/guestOrder/graphql/guestOrder.graphql';\nimport { GuestOrderQuery } from '@/order-confirmation/__generated__/types';\n\n\nexport type GuestOrderInput = {\n  email: string;\n  number: string;\n  postcode: string;\n};\n\nexport const guestOrder = async (input: GuestOrderInput) => {\n  const { data, errors } = await fetchGraphQl<GuestOrderQuery>(\n    guestOrderQuery,\n    {\n      variables: {  ...input },\n    },\n  );\n\n  if (errors) throw new FetchError(errors);\n\n  const order = data?.guestOrder;\n\n  if (!order) throw new OrderNotFound();\n\n  return order;\n};","import { GUEST_ORDER_FRAGMENT } from '@/order-confirmation/api/guestOrder/graphql/guestOrder.graphql';\nexport const guestOrderByTokenQuery = /* GraphQL */ `\n  query guestOrderByToken($token: String!) {\n    guestOrderByToken(input: {token: $token}) {\n      ...guestOrderData\n    }\n  }\n  ${GUEST_ORDER_FRAGMENT}\n`;\n","import { fetchGraphQl } from '@/order-confirmation/api';\nimport {\n  FetchError,\n  OrderNotFound,\n} from '@/order-confirmation/api/errors';\nimport { guestOrderByTokenQuery } from '@/order-confirmation/api/guestOrderByToken/graphql/guestOrderByToken.graphql';\nimport { GuestOrderByTokenQuery } from '@/order-confirmation/__generated__/types';\n\n\nexport const guestOrderByToken = async (token: string) => {\n  const { data, errors } = await fetchGraphQl<GuestOrderByTokenQuery>(\n    guestOrderByTokenQuery,\n    {\n      variables: {  token },\n    },\n  );\n\n  if (errors) throw new FetchError(errors);\n\n  const order = data?.guestOrderByToken;\n  const hasOrder = !!order;\n\n  if (!hasOrder) throw new OrderNotFound();\n\n  return order;\n};"],"names":["FetchError","Error","constructor","reasons","map","e","message","join","name","MissingArgument","argument","OrderNotFound","setEndpoint","setFetchGraphQlHeader","removeFetchGraphQlHeader","setFetchGraphQlHeaders","fetchGraphQl","getConfig","FetchGraphQL","getMethods","GUEST_ORDER_FRAGMENT","guestOrderQuery","guestOrder","input","data","errors","variables","order","guestOrderByTokenQuery","guestOrderByToken","token","hasOrder"],"mappings":";AAEO,MAAMA,mBAAmBC,MAAM;AAAA,EACpCC,YAAYC,SAA0B;AAC9BA,UAAAA,QAAQC,IAAI,CAACC,MAAWA,EAAEC,OAAO,EAAEC,KAAK,GAAG,CAAC;AAClD,SAAKC,OAAO;AAAA,EACd;AACF;AAEO,MAAMC,wBAAwBR,MAAM;AAAA,EACzCC,YAAYQ,UAAkB;AACrB,UAAA,qBAAoBA,QAAS,EAAC;AAAA,EACvC;AACF;AAEO,MAAMC,sBAAsBV,MAAM;AAAA,EACvCC,cAAc;AACZ,UAAM,iBAAiB;AAAA,EACzB;AACF;ACjBa,MAAA;AAAA,EACXU;AAAAA,EACAC;AAAAA,EACAC;AAAAA,EACAC;AAAAA,EACAC;AAAAA,EACAC;AACF,IAAI,IAAIC,aAAa,EAAEC,WAAW;ACTrBC,MAAAA;AAAAA;AAAAA,EAAsC;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AA4FtCC,MAAAA;AAAAA;AAAAA,EAAiC;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,IAM1CD,oBAAqB;AAAA;AAAA;ACnFZE,MAAAA,aAAa,OAAOC,UAA2B;AACpD,QAAA;AAAA,IAAEC;AAAAA,IAAMC;AAAAA,EAAAA,IAAW,MAAMT,aAC7BK,iBACA;AAAA,IACEK,WAAW;AAAA,MAAG,GAAGH;AAAAA,IAAM;AAAA,EAAA,CAE3B;AAEIE,MAAAA;AAAc,UAAA,IAAIzB,WAAWyB,MAAM;AAEvC,QAAME,QAAQH,6BAAMF;AAEpB,MAAI,CAACK;AAAO,UAAM,IAAIhB,cAAc;AAE7BgB,SAAAA;AACT;AC7BaC,MAAAA;AAAAA;AAAAA,EAAwC;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,IAMjDR,oBAAqB;AAAA;AAAA;ACEZS,MAAAA,oBAAoB,OAAOC,UAAkB;AAClD,QAAA;AAAA,IAAEN;AAAAA,IAAMC;AAAAA,EAAAA,IAAW,MAAMT,aAC7BY,wBACA;AAAA,IACEF,WAAW;AAAA,MAAGI;AAAAA,IAAM;AAAA,EAAA,CAExB;AAEIL,MAAAA;AAAc,UAAA,IAAIzB,WAAWyB,MAAM;AAEvC,QAAME,QAAQH,6BAAMK;AACdE,QAAAA,WAAW,CAAC,CAACJ;AAEnB,MAAI,CAACI;AAAU,UAAM,IAAIpB,cAAc;AAEhCgB,SAAAA;AACT;"}