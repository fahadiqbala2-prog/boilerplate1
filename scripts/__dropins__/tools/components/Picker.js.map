{"version":3,"file":"Picker.js","sources":["../../src/components/Picker/Picker.tsx"],"sourcesContent":["import { Icon } from '@adobe/elsie/components';\nimport '@adobe/elsie/components/Picker/Picker.css';\nimport { ChevronDown } from '@adobe/elsie/icons';\nimport { classes } from '@adobe/elsie/lib';\nimport { FunctionComponent, VNode } from 'preact';\nimport { HTMLAttributes, useEffect, useState } from 'preact/compat';\nimport { useRef } from 'preact/hooks';\n\nexport interface PickerOption {\n  value: string | null;\n  text?: string;\n  icon?: VNode<HTMLAttributes<SVGSVGElement>>;\n  disabled?: boolean;\n}\n\nexport interface PickerProps\n  extends Omit<HTMLAttributes<HTMLSelectElement>, 'value' | 'size' | 'icon'> {\n  id?: string;\n  name?: string;\n  value?: string | null;\n  placeholder?: string;\n  variant?: 'primary' | 'secondary';\n  size?: 'medium' | 'large';\n  floatingLabel?: string;\n  icon?: VNode<HTMLAttributes<SVGSVGElement>>;\n  options?: PickerOption[];\n  defaultOption?: PickerOption;\n  disabled?: boolean;\n  error?: boolean;\n  handleSelect?: (event: Event) => void;\n}\n\nexport const Picker: FunctionComponent<PickerProps> = ({\n  name,\n  value = null,\n  options,\n  variant = 'primary',\n  floatingLabel,\n  size = 'medium',\n  handleSelect = () => {},\n  disabled = false,\n  error = false,\n  placeholder,\n  defaultOption,\n  icon,\n  className,\n  ...props\n}) => {\n  const id = props?.id || name || `dropin-picker-${Math.random().toString(36)}`;\n\n  // find the first option that is not disabled\n  const firstAvailableeOption = options?.find((option) => !option.disabled);\n\n  const [selectedValue, setSelectedValue] = useState<PickerOption>({\n    value,\n    text: defaultOption?.text || placeholder || firstAvailableeOption?.text,\n    icon,\n  });\n\n  useEffect(() => {\n    const selected = options?.find((option) => option.value === value);\n\n    setSelectedValue(\n      selected ?? {\n        value:\n          (defaultOption?.value as string) ||\n          ((placeholder || floatingLabel\n            ? null\n            : firstAvailableeOption?.value) as string),\n        text: defaultOption?.text || placeholder || firstAvailableeOption?.text,\n        icon,\n      }\n    );\n  }, [value, options, placeholder, icon, defaultOption, floatingLabel]);\n\n  const handleOptionClick = (event: Event) => {\n    const { options, value } = event.target as HTMLSelectElement;\n\n    for (const element of options) {\n      if (element.selected) {\n        setSelectedValue({ value, text: element.text, icon });\n        handleSelect(event);\n      }\n    }\n  };\n\n  const optionsListItems = options?.map((option) => {\n    const { value, text, disabled } = option;\n    const selected = value === selectedValue.value;\n\n    return (\n      <option\n        value={value as string}\n        key={value}\n        selected={selected}\n        disabled={disabled}\n        className={classes(['dropin-picker__option'])}\n      >\n        {text}\n      </option>\n    );\n  });\n\n  const placeholderOptionRef = useRef(null);\n  // @ts-ignore\n  const selected = !placeholderOptionRef.current?.selected || !!defaultOption;\n\n  return (\n    <div\n      className={classes([\n        className,\n        'dropin-picker',\n        `dropin-picker__${size}`,\n        ['dropin-picker__floating', !!floatingLabel],\n        ['dropin-picker__selected', selected],\n        ['dropin-picker__error', error],\n        ['dropin-picker__disabled', disabled],\n        ['dropin-picker__icon', icon],\n      ])}\n    >\n      {icon && (\n        // @ts-ignore\n        <icon.type\n          {...icon.props}\n          className={'dropin-picker__icon--placeholder'}\n        />\n      )}\n\n      <select\n        id={id}\n        className={classes([\n          'dropin-picker__select',\n          `dropin-picker__select--${variant}`,\n          `dropin-picker__select--${size}`,\n          ['dropin-picker__select--floating', !!floatingLabel],\n        ])}\n        name={name}\n        aria-label={name}\n        disabled={disabled}\n        onChange={handleOptionClick}\n        {...props}\n      >\n        {!defaultOption && (floatingLabel || placeholder) && (\n          <option\n            value={''}\n            key={value}\n            ref={placeholderOptionRef}\n            className={classes([\n              'dropin-picker__option dropin-picker__placeholder',\n            ])}\n          >\n            {floatingLabel ?? placeholder}\n          </option>\n        )}\n\n        {optionsListItems}\n      </select>\n\n      <Icon\n        source={ChevronDown}\n        size=\"24\"\n        stroke=\"2\"\n        className=\"dropin-picker__chevronDown\"\n      />\n\n      {floatingLabel && selected && (\n        <label\n          htmlFor={id}\n          className={classes(['dropin-picker__floatingLabel', !!floatingLabel])}\n        >\n          {floatingLabel}\n        </label>\n      )}\n    </div>\n  );\n};\n"],"names":["Picker","name","value","options","variant","floatingLabel","size","handleSelect","disabled","error","placeholder","defaultOption","icon","className","props","id","Math","random","toString","firstAvailableeOption","find","option","selectedValue","setSelectedValue","useState","text","useEffect","selected","handleOptionClick","event","target","element","optionsListItems","map","_jsx","classes","children","placeholderOptionRef","useRef","current","_jsxs","type","onChange","ref","Icon","source","ChevronDown","stroke","htmlFor"],"mappings":"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"}