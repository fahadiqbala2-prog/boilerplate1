{"version":3,"file":"ColorSwatch.js","sources":["../../src/components/ColorSwatch/ColorSwatch.tsx"],"sourcesContent":["import { FunctionComponent } from 'preact';\nimport { HTMLAttributes, useCallback } from 'preact/compat';\nimport { classes } from '@adobe/elsie/lib';\nimport '@adobe/elsie/components/ColorSwatch/ColorSwatch.css';\nimport { useText } from '@adobe/elsie/i18n';\n\nexport interface ColorSwatchProps\n  extends Omit<HTMLAttributes<HTMLInputElement>, 'label' | 'size'> {\n  name?: string;\n  label?: string;\n  groupAriaLabel?: string;\n  id?: string;\n  size?: 'medium' | 'large';\n  color?: string;\n  value?: string;\n  disabled?: boolean;\n  selected?: boolean;\n  outOfStock?: boolean;\n  multi?: boolean;\n  onValue?: (value: any) => void;\n  onUpdateError?: (error: Error) => void;\n}\n\nexport const ColorSwatch: FunctionComponent<ColorSwatchProps> = ({\n  className,\n  name,\n  value,\n  id,\n  label,\n  groupAriaLabel,\n  size = 'medium',\n  color,\n  disabled = false,\n  selected = false,\n  outOfStock = false,\n  multi = false,\n  onValue,\n  onUpdateError,\n  ...props\n}) => {\n  // i18n\n  const outOfStockLabel = useText('Dropin.Swatches.outOfStock.label').label;\n  const selectedLabel = useText('Dropin.Swatches.selected.label').label;\n  const swatchLabel = useText('Dropin.Swatches.swatch.label').label;\n\n  const onValueHandler = useCallback(\n    async (newValue: any) => {\n      if (onValue) {\n        try {\n          await onValue(newValue);\n        } catch (e) {\n          if (onUpdateError) {\n            onUpdateError(e as Error);\n          }\n        }\n      }\n    },\n    [onValue, onUpdateError]\n  );\n\n  const handleOnValue = (e: Event) => {\n    const input = e.target as HTMLInputElement;\n\n    onValueHandler(input.value);\n  };\n\n  const isValidColor = (color: string) => {\n    const colorStyle = new Option().style;\n    colorStyle.color = color;\n    return colorStyle.color !== ''; // Returns true if the browser accepts this as a valid color\n  };\n\n  const defaultColor = 'var(--color-gray-300);';\n\n  const validColor = color && isValidColor(color) ? color : defaultColor;\n\n  const handleAriaLabel = () => {\n    if (outOfStock) return `${groupAriaLabel}: ${label} ${outOfStockLabel}`;\n    if (selected) return `${groupAriaLabel}: ${label} ${selectedLabel}`;\n    return `${groupAriaLabel}: ${label} ${swatchLabel}`;\n  };\n\n  return (\n    <label\n      className={classes([\n        'dropin-color-swatch__container',\n        `dropin-color-swatch__container--${size}`,\n        className,\n      ])}\n    >\n      <input\n        type={multi ? 'checkbox' : 'radio'}\n        name={name}\n        id={id}\n        value={value}\n        aria-label={handleAriaLabel()}\n        checked={selected}\n        disabled={disabled}\n        onChange={handleOnValue}\n        {...props}\n        className={classes([\n          'dropin-color-swatch',\n          ['dropin-color-swatch--selected', selected],\n          ['dropin-color-swatch--disabled', disabled],\n          className,\n        ])}\n      />\n      <span\n        style={{ '--bg-color': validColor }}\n        className={classes([\n          'dropin-color-swatch__span',\n          ['dropin-color-swatch__span--out-of-stock', outOfStock],\n          className,\n        ])}\n      />\n    </label>\n  );\n};\n"],"names":["ColorSwatch","className","name","value","id","label","groupAriaLabel","size","color","disabled","selected","outOfStock","multi","onValue","onUpdateError","props","outOfStockLabel","useText","selectedLabel","swatchLabel","onValueHandler","useCallback","newValue","e","handleOnValue","input","target","validColor","colorStyle","Option","style","handleAriaLabel","_jsxs","classes","children","_jsx","type","checked","onChange"],"mappings":"gVAuBO,MAAMA,EAAmDA,CAAC,CAC/DC,UAAAA,EACAC,KAAAA,EACAC,MAAAA,EACAC,GAAAA,EACAC,MAAAA,EACAC,eAAAA,EACAC,KAAAA,EAAO,SACPC,MAAAA,EACAC,SAAAA,EAAW,GACXC,SAAAA,EAAW,GACXC,WAAAA,EAAa,GACbC,MAAAA,EAAQ,GACRC,QAAAA,EACAC,cAAAA,EACA,GAAGC,CACL,IAAM,CAEEC,MAAAA,EAAkBC,EAAQ,kCAAkC,EAAEZ,MAC9Da,EAAgBD,EAAQ,gCAAgC,EAAEZ,MAC1Dc,EAAcF,EAAQ,8BAA8B,EAAEZ,MAEtDe,EAAiBC,EACrB,MAAOC,GAAkB,CACvB,GAAIT,EACE,GAAA,CACF,MAAMA,EAAQS,CAAQ,QACfC,EAAG,CACNT,GACFA,EAAcS,CAAW,CAE7B,CACF,EAEF,CAACV,EAASC,CAAa,CACzB,EAEMU,EAAiBD,GAAa,CAClC,MAAME,EAAQF,EAAEG,OAEhBN,EAAeK,EAAMtB,KAAK,CAAA,EAWtBwB,EAAanB,IARGA,GAAkB,CAChCoB,MAAAA,EAAa,IAAIC,OAASC,EAAAA,MAChCF,OAAAA,EAAWpB,MAAQA,EACZoB,EAAWpB,QAAU,EAAA,GAKWA,CAAK,EAAIA,EAF7B,yBAIfuB,EAAkBA,IAClBpB,EAAoB,GAAEL,CAAe,KAAID,CAAM,IAAGW,CAAgB,GAClEN,EAAkB,GAAEJ,CAAe,KAAID,CAAM,IAAGa,CAAc,GAC1D,GAAEZ,CAAe,KAAID,CAAM,IAAGc,CAAY,GAGpD,OACEa,EAAA,QAAA,CACE/B,UAAWgC,EAAQ,CACjB,iCACC,mCAAkC1B,CAAK,GACxCN,CAAS,CACV,EAAEiC,UAEHC,EAAA,QAAA,CACEC,KAAMxB,EAAQ,WAAa,QAC3BV,KAAAA,EACAE,GAAAA,EACAD,MAAAA,EACA,aAAY4B,EAAgB,EAC5BM,QAAS3B,EACTD,SAAAA,EACA6B,SAAUd,EAAc,GACpBT,EACJd,UAAWgC,EAAQ,CACjB,sBACA,CAAC,gCAAiCvB,CAAQ,EAC1C,CAAC,gCAAiCD,CAAQ,EAC1CR,CAAS,CACV,CAAA,CACF,EACDkC,EAAA,OAAA,CACEL,MAAO,CAAE,aAAcH,CAAW,EAClC1B,UAAWgC,EAAQ,CACjB,4BACA,CAAC,0CAA2CtB,CAAU,EACtDV,CAAS,CACV,CAAA,CACF,CAAC,CAAA,CACG,CAEX"}