{"version":3,"file":"Modal.js","sources":["../../src/components/Modal/Modal.tsx"],"sourcesContent":["/*\nADOBE CONFIDENTIAL\nCopyright 2023 Adobe\nAll Rights Reserved.\nNOTICE: All information contained herein is, and remains\nthe property of Adobe and its suppliers, if any. The intellectual\nand technical concepts contained herein are proprietary to Adobe\nand its suppliers and are protected by all applicable intellectual\nproperty laws, including trade secret and copyright laws.\nDissemination of this information or reproduction of this material\nis strictly forbidden unless prior written permission is obtained\nfrom Adobe.\n*/\n\nimport { useText } from '@adobe/elsie/i18n';\nimport { classes } from '@adobe/elsie/lib';\nimport {\n  FunctionComponent,\n  HTMLAttributes,\n  useCallback,\n  useEffect,\n} from 'preact/compat';\nimport { Button } from '../Button';\nimport { Close as CloseSVG } from '@adobe/elsie/icons';\nimport { VNode } from 'preact';\n\nimport '@adobe/elsie/components/Modal/Modal.css';\n\nexport interface ModalProps\n  extends Omit<HTMLAttributes<HTMLDivElement>, 'size' | 'title'> {\n  size?: 'small' | 'medium' | 'full';\n  title?: VNode;\n  centered?: boolean;\n  onClose?: () => void;\n  backgroundDim?: boolean;\n  clickToDismiss?: boolean;\n  escapeToDismiss?: boolean;\n  showCloseButton?: boolean;\n}\n\nexport const Modal: FunctionComponent<ModalProps> = ({\n  size = 'small',\n  title = null,\n  centered = false,\n  backgroundDim = true,\n  clickToDismiss = true,\n  escapeToDismiss = true,\n  onClose,\n  showCloseButton = true,\n  className,\n  children = null,\n  ...props\n}) => {\n  const handleOnClose = useCallback(() => {\n    onClose?.();\n  }, [onClose]);\n\n  const translations = useText({\n    modalCloseLabel: 'Dropin.Modal.Close.label',\n  });\n\n  // Close on background click\n  useEffect(() => {\n    const handleOutsideClick = (event: MouseEvent) => {\n      const modal = document.querySelector('.dropin-modal');\n      const modalBody = document.querySelector('.dropin-modal__body');\n\n      if (\n        clickToDismiss &&\n        modal &&\n        modalBody &&\n        !modalBody.contains(event.target as Node)\n      ) {\n        handleOnClose();\n      }\n    };\n\n    document.addEventListener('mousedown', handleOutsideClick);\n\n    return () => {\n      document.removeEventListener('mousedown', handleOutsideClick);\n    };\n  }, [handleOnClose, clickToDismiss]);\n\n  // Close on ESC\n  useEffect(() => {\n    const handleKeyDown = (event: KeyboardEvent) => {\n      if (event.key === 'Escape' && escapeToDismiss) {\n        handleOnClose();\n      }\n    };\n\n    document.addEventListener('keydown', handleKeyDown);\n\n    return () => {\n      document.removeEventListener('keydown', handleKeyDown);\n    };\n  }, [handleOnClose, escapeToDismiss]);\n\n  // Prevent document scrolling\n  useEffect(() => {\n    const scrollingElement = document.scrollingElement as HTMLElement;\n\n    const defaultOverflowValue = scrollingElement.style.overflow;\n\n    scrollingElement.style.overflow = 'hidden';\n\n    return () => {\n      scrollingElement.style.overflow = defaultOverflowValue;\n    };\n  }, []);\n\n  return (\n    <div\n      className={classes([\n        'dropin-modal',\n        ['dropin-modal--dim', backgroundDim],\n      ])}\n    >\n      <div\n        {...props}\n        className={classes([\n          'dropin-modal__body',\n          [`dropin-modal__body--${size}`, size],\n          className,\n        ])}\n      >\n        <div\n          className={classes([\n            'dropin-modal__header',\n            ['dropin-modal__header-title', !!title],\n          ])}\n        >\n          {title && (\n            <div className={classes(['dropin-modal__header-title-content'])}>\n              {title}\n            </div>\n          )}\n\n          {showCloseButton && (\n            <Button\n              aria-label={translations.modalCloseLabel}\n              variant=\"tertiary\"\n              className=\"dropin-modal__header-close-button\"\n              onClick={handleOnClose}\n              icon={<CloseSVG />}\n            />\n          )}\n        </div>\n\n        <div\n          className={classes([\n            'dropin-modal__content',\n            ['dropin-modal__body--centered', centered],\n          ])}\n        >\n          {children}\n        </div>\n      </div>\n    </div>\n  );\n};\n"],"names":["Modal","size","title","centered","backgroundDim","clickToDismiss","escapeToDismiss","onClose","showCloseButton","className","children","props","handleOnClose","useCallback","translations","useText","modalCloseLabel","useEffect","handleOutsideClick","event","modal","document","querySelector","modalBody","contains","target","addEventListener","removeEventListener","handleKeyDown","key","scrollingElement","defaultOverflowValue","style","overflow","_jsx","classes","_jsxs","Button","variant","onClick","icon","CloseSVG"],"mappings":"odAwCO,MAAMA,EAAuCA,CAAC,CACnDC,KAAAA,EAAO,QACPC,MAAAA,EAAQ,KACRC,SAAAA,EAAW,GACXC,cAAAA,EAAgB,GAChBC,eAAAA,EAAiB,GACjBC,gBAAAA,EAAkB,GAClBC,QAAAA,EACAC,gBAAAA,EAAkB,GAClBC,UAAAA,EACAC,SAAAA,EAAW,KACX,GAAGC,CACL,IAAM,CACEC,MAAAA,EAAgBC,EAAY,IAAM,CAC5BN,GAAA,MAAAA,GAAA,EACT,CAACA,CAAO,CAAC,EAENO,EAAeC,EAAQ,CAC3BC,gBAAiB,0BAAA,CAClB,EAGDC,OAAAA,EAAU,IAAM,CACRC,MAAAA,EAAsBC,GAAsB,CAC1CC,MAAAA,EAAQC,SAASC,cAAc,eAAe,EAC9CC,EAAYF,SAASC,cAAc,qBAAqB,EAG5DjB,GACAe,GACAG,GACA,CAACA,EAAUC,SAASL,EAAMM,SAEZb,GAChB,EAGOc,gBAAAA,iBAAiB,YAAaR,CAAkB,EAElD,IAAM,CACFS,SAAAA,oBAAoB,YAAaT,CAAkB,CAAA,CAC9D,EACC,CAACN,EAAeP,CAAc,CAAC,EAGlCY,EAAU,IAAM,CACRW,MAAAA,EAAiBT,GAAyB,CAC1CA,EAAMU,MAAQ,UAAYvB,GACdM,GAChB,EAGOc,gBAAAA,iBAAiB,UAAWE,CAAa,EAE3C,IAAM,CACFD,SAAAA,oBAAoB,UAAWC,CAAa,CAAA,CACvD,EACC,CAAChB,EAAeN,CAAe,CAAC,EAGnCW,EAAU,IAAM,CACd,MAAMa,EAAmBT,SAASS,iBAE5BC,EAAuBD,EAAiBE,MAAMC,SAEpDH,OAAAA,EAAiBE,MAAMC,SAAW,SAE3B,IAAM,CACXH,EAAiBE,MAAMC,SAAWF,CAAAA,CAEtC,EAAG,CAAE,CAAA,EAGHG,EAAA,MAAA,CACEzB,UAAW0B,EAAQ,CACjB,eACA,CAAC,oBAAqB/B,CAAa,CAAC,CACrC,EAAEM,SAEH0B,EAAA,MAAA,CAAA,GACMzB,EACJF,UAAW0B,EAAQ,CACjB,qBACA,CAAE,uBAAsBlC,CAAK,GAAGA,CAAI,EACpCQ,CAAS,CACV,EAAEC,UAEH0B,EAAA,MAAA,CACE3B,UAAW0B,EAAQ,CACjB,uBACA,CAAC,6BAA8B,CAAC,CAACjC,CAAK,CAAC,CACxC,EAAEQ,SAAA,CAEFR,GACCgC,EAAA,MAAA,CAAKzB,UAAW0B,EAAQ,CAAC,oCAAoC,CAAC,EAAEzB,SAC7DR,CAAAA,CACE,EAGNM,GACC0B,EAACG,EAAM,CACL,aAAYvB,EAAaE,gBACzBsB,QAAQ,WACR7B,UAAU,oCACV8B,QAAS3B,EACT4B,KAAMN,EAACO,EAAU,EAAA,CAAA,CAClB,CACF,CAAA,CACE,EAELP,EAAA,MAAA,CACEzB,UAAW0B,EAAQ,CACjB,wBACA,CAAC,+BAAgChC,CAAQ,CAAC,CAC3C,EAAEO,SAAAA,CAAAA,CAGA,CAAC,CAAA,CACH,CAAA,CACF,CAET"}