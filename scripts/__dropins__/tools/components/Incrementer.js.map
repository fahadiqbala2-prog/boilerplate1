{"version":3,"file":"Incrementer.js","sources":["../../src/components/Incrementer/Incrementer.tsx"],"sourcesContent":["import { FunctionComponent } from 'preact';\nimport { useState, useEffect, useCallback } from 'preact/hooks';\nimport { HTMLAttributes } from 'preact/compat';\nimport { classes, debounce } from '@adobe/elsie/lib';\nimport { Add, Minus } from '@adobe/elsie/icons';\nimport { Icon } from '@adobe/elsie/components/Icon';\nimport { Localizer, Text } from '@adobe/elsie/i18n';\nimport '@adobe/elsie/components/Incrementer/Incrementer.css';\n\nexport interface IncrementerProps\n  extends Omit<HTMLAttributes<HTMLInputElement>, 'size'> {\n  name?: string;\n  size?: 'medium' | 'large';\n  onValue?: (value: any) => void;\n  onUpdateError?: (error: Error) => void;\n  error?: boolean;\n  success?: boolean;\n  min?: number;\n  max?: number;\n  disabled?: boolean;\n  maxLength?: number;\n}\n\nexport const Incrementer: FunctionComponent<IncrementerProps> = ({\n  name,\n  value = '1',\n  className,\n  disabled,\n  error,\n  success,\n  min,\n  max,\n  onValue,\n  onUpdateError,\n  size = 'medium',\n  ...props\n}) => {\n  const [currentValue, setCurrentValue] = useState<number>(Number(value));\n  const minValue = Number(min);\n  const maxValue = Number(max);\n\n  useEffect(() => {\n    setCurrentValue(Number(value));\n  }, [value]);\n\n  // eslint-disable-next-line react-hooks/exhaustive-deps\n  const debouncedOnValueHandler = useCallback(\n    debounce(async (newValue: any) => {\n      if (onValue) {\n        try {\n          await onValue(newValue);\n        } catch (e) {\n          if (onUpdateError) {\n            onUpdateError(e as Error);\n          }\n        }\n      }\n    }, 200),\n    [onValue, onUpdateError]\n  );\n\n  const handleIncrementer = (_value: number) => {\n    let newValue = _value;\n    if (_value < minValue) newValue = minValue;\n    if (_value > maxValue) newValue = maxValue;\n    debouncedOnValueHandler(newValue);\n    setCurrentValue(newValue);\n  };\n\n  return (\n    <div\n      className={classes([\n        'dropin-incrementer',\n        `dropin-incrementer--${size}`,\n        className,\n      ])}\n    >\n      <div\n        className={classes([\n          'dropin-incrementer__content',\n          `dropin-incrementer__content--${size}`,\n          [`dropin-incrementer__content--error`, error],\n          [`dropin-incrementer__content--success`, success],\n          [`dropin-incrementer__content--disabled`, disabled],\n        ])}\n      >\n        {/* Minus Button */}\n        <div\n          className={classes([\n            'dropin-incrementer__button-container',\n            [`dropin-incrementer__button-container--disabled`, disabled],\n          ])}\n        >\n          <Localizer>\n            <button\n              type=\"button\"\n              className={classes([\n                'dropin-incrementer__decrease-button',\n                [`dropin-incrementer__decrease-button--disabled`, disabled],\n              ])}\n              onClick={() => handleIncrementer(currentValue - 1)}\n              disabled={disabled || currentValue < minValue + 1}\n              aria-label={\n                (<Text id=\"Dropin.Incrementer.decreaseLabel\" />) as any\n              }\n            >\n              <Icon\n                source={Minus}\n                size=\"16\"\n                stroke=\"1\"\n                viewBox=\"4 2 20 20\"\n                className=\"dropin-incrementer__down\"\n              />\n            </button>\n          </Localizer>\n        </div>\n\n        {/* Input Field */}\n        <input\n          className=\"dropin-incrementer__input\"\n          max={max}\n          min={min}\n          step={1}\n          type=\"number\"\n          name={name}\n          value={currentValue}\n          disabled={disabled}\n          onChange={(e) => {\n            const newValue = e.currentTarget.value;\n            if (newValue !== '') {\n              handleIncrementer(Number(newValue));\n            }\n          }}\n          {...props}\n        />\n\n        <div\n          className={classes([\n            'dropin-incrementer__button-container',\n            [`dropin-incrementer__button-container--disabled`, disabled],\n          ])}\n        >\n          {/* Plus/Add button */}\n          <Localizer>\n            <button\n              type=\"button\"\n              className={classes([\n                'dropin-incrementer__increase-button',\n                [`dropin-incrementer__increase-button--disabled`, disabled],\n              ])}\n              onClick={() => handleIncrementer(currentValue + 1)}\n              disabled={disabled || currentValue > maxValue - 1}\n              aria-label={\n                (<Text id=\"Dropin.Incrementer.increaseLabel\" />) as any\n              }\n            >\n              <Icon\n                source={Add}\n                size=\"16\"\n                stroke=\"1\"\n                viewBox=\"4 2 20 20\"\n                className=\"dropin-incrementer__add\"\n              />\n            </button>\n          </Localizer>\n        </div>\n      </div>\n    </div>\n  );\n};\n"],"names":["Incrementer","name","value","className","disabled","error","success","min","max","onValue","onUpdateError","size","props","currentValue","setCurrentValue","useState","Number","minValue","maxValue","useEffect","debouncedOnValueHandler","useCallback","debounce","newValue","e","handleIncrementer","_value","_jsx","classes","children","_jsxs","Localizer","type","onClick","Text","id","Icon","source","Minus","stroke","viewBox","step","onChange","currentTarget","Add"],"mappings":"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"}