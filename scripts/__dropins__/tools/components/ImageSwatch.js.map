{"version":3,"file":"ImageSwatch.js","sources":["../../src/components/ImageSwatch/ImageSwatch.tsx"],"sourcesContent":["import { FunctionComponent } from 'preact';\nimport { HTMLAttributes, useCallback } from 'preact/compat';\nimport { classes } from '@adobe/elsie/lib';\nimport '@adobe/elsie/components/ImageSwatch/ImageSwatch.css';\nimport { Image } from '@adobe/elsie/components/Image';\nimport { useText } from '@adobe/elsie/i18n';\n\nexport interface ImageSwatchProps\n  extends Omit<HTMLAttributes<HTMLInputElement>, 'label'> {\n  name?: string;\n  label?: string;\n  groupAriaLabel?: string;\n  id?: string;\n  src: string;\n  alt?: string;\n  value?: string;\n  disabled?: boolean;\n  selected?: boolean;\n  outOfStock?: boolean;\n  multi?: boolean;\n  onValue?: (value: any) => void;\n  onUpdateError?: (error: Error) => void;\n}\n\nexport const ImageSwatch: FunctionComponent<ImageSwatchProps> = ({\n  className,\n  name,\n  value,\n  id,\n  label,\n  groupAriaLabel,\n  src,\n  alt,\n  disabled = false,\n  selected = false,\n  outOfStock = false,\n  multi = false,\n  onValue,\n  onUpdateError,\n  ...props\n}) => {\n  const outOfStockLabel = useText('Dropin.Swatches.outOfStock.label').label;\n  const selectedLabel = useText('Dropin.Swatches.selected.label').label;\n  const swatchLabel = useText('Dropin.Swatches.swatch.label').label;\n\n  const onValueHandler = useCallback(\n    async (newValue: any) => {\n      if (onValue) {\n        try {\n          await onValue(newValue);\n        } catch (e) {\n          if (onUpdateError) {\n            onUpdateError(e as Error);\n          }\n        }\n      }\n    },\n    [onValue, onUpdateError]\n  );\n\n  const handleOnValue = (e: Event) => {\n    const input = e.target as HTMLInputElement;\n\n    onValueHandler(input.value);\n  };\n\n  const handleAriaLabel = () => {\n    if (outOfStock) return `${groupAriaLabel}: ${label} ${outOfStockLabel}`;\n    if (selected) return `${groupAriaLabel}: ${label} ${selectedLabel}`;\n    return `${groupAriaLabel}: ${label} ${swatchLabel}`;\n  };\n\n  return (\n    <label className={classes(['dropin-image-swatch__container', className])}>\n      <input\n        type={multi ? 'checkbox' : 'radio'}\n        name={name}\n        id={id}\n        value={value}\n        aria-label={handleAriaLabel()}\n        checked={selected}\n        disabled={disabled}\n        onChange={handleOnValue}\n        {...props}\n        className={classes([\n          'dropin-image-swatch',\n          ['dropin-image-swatch--selected', selected],\n          ['dropin-image-swatch--disabled', disabled],\n          className,\n        ])}\n      />\n\n      <span\n        className={classes([\n          'dropin-image-swatch__span',\n          ['dropin-image-swatch__span--out-of-stock', outOfStock],\n          className,\n        ])}\n      >\n        <Image\n          src={src}\n          className={classes(['dropin-image-swatch__content'])}\n          params={{ width: 100, fit: 'bounds', crop: true }}\n          alt={alt}\n          loading={'lazy'}\n          onError={(e: any) => (e.target.style.display = 'none')}\n        />\n      </span>\n    </label>\n  );\n};\n"],"names":["ImageSwatch","className","name","value","id","label","groupAriaLabel","src","alt","disabled","selected","outOfStock","multi","onValue","onUpdateError","props","outOfStockLabel","useText","selectedLabel","swatchLabel","onValueHandler","useCallback","newValue","e","handleOnValue","input","target","handleAriaLabel","_jsxs","classes","children","_jsx","type","checked","onChange","Image","params","width","fit","crop","loading","onError","style","display"],"mappings":"2SAwBO,MAAMA,EAAmDA,CAAC,CAC/DC,UAAAA,EACAC,KAAAA,EACAC,MAAAA,EACAC,GAAAA,EACAC,MAAAA,EACAC,eAAAA,EACAC,IAAAA,EACAC,IAAAA,EACAC,SAAAA,EAAW,GACXC,SAAAA,EAAW,GACXC,WAAAA,EAAa,GACbC,MAAAA,EAAQ,GACRC,QAAAA,EACAC,cAAAA,EACA,GAAGC,CACL,IAAM,CACEC,MAAAA,EAAkBC,EAAQ,kCAAkC,EAAEZ,MAC9Da,EAAgBD,EAAQ,gCAAgC,EAAEZ,MAC1Dc,EAAcF,EAAQ,8BAA8B,EAAEZ,MAEtDe,EAAiBC,EACrB,MAAOC,GAAkB,CACvB,GAAIT,EACE,GAAA,CACF,MAAMA,EAAQS,CAAQ,QACfC,EAAG,CACNT,GACFA,EAAcS,CAAW,CAE7B,CACF,EAEF,CAACV,EAASC,CAAa,CACzB,EAEMU,EAAiBD,GAAa,CAClC,MAAME,EAAQF,EAAEG,OAEhBN,EAAeK,EAAMtB,KAAK,CAAA,EAGtBwB,EAAkBA,IAClBhB,EAAoB,GAAEL,CAAe,KAAID,CAAM,IAAGW,CAAgB,GAClEN,EAAkB,GAAEJ,CAAe,KAAID,CAAM,IAAGa,CAAc,GAC1D,GAAEZ,CAAe,KAAID,CAAM,IAAGc,CAAY,GAGpD,OACES,EAAA,QAAA,CAAO3B,UAAW4B,EAAQ,CAAC,iCAAkC5B,CAAS,CAAC,EAAE6B,UACvEC,EAAA,QAAA,CACEC,KAAMpB,EAAQ,WAAa,QAC3BV,KAAAA,EACAE,GAAAA,EACAD,MAAAA,EACA,aAAYwB,EAAgB,EAC5BM,QAASvB,EACTD,SAAAA,EACAyB,SAAUV,EAAc,GACpBT,EACJd,UAAW4B,EAAQ,CACjB,sBACA,CAAC,gCAAiCnB,CAAQ,EAC1C,CAAC,gCAAiCD,CAAQ,EAC1CR,CAAS,CACV,CAAA,CACF,EAED8B,EAAA,OAAA,CACE9B,UAAW4B,EAAQ,CACjB,4BACA,CAAC,0CAA2ClB,CAAU,EACtDV,CAAS,CACV,EAAE6B,SAEHC,EAACI,EAAK,CACJ5B,IAAAA,EACAN,UAAW4B,EAAQ,CAAC,8BAA8B,CAAC,EACnDO,OAAQ,CAAEC,MAAO,IAAKC,IAAK,SAAUC,KAAM,EAAK,EAChD/B,IAAAA,EACAgC,QAAS,OACTC,QAAUlB,GAAYA,EAAEG,OAAOgB,MAAMC,QAAU,MAAA,CAChD,CAAA,CACG,CAAC,CAAA,CACF,CAEX"}