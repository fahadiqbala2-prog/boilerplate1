/*! Copyright 2025 Adobe
All Rights Reserved. */
import{jsx as r}from"@dropins/tools/preact-jsx-runtime.js";import*as s from"@dropins/tools/preact-compat.js";import{useState as S,useEffect as b}from"@dropins/tools/preact-compat.js";import{VComponent as j,classes as B,Slot as g}from"@dropins/tools/lib.js";import{events as _}from"@dropins/tools/event-bus.js";import{InLineAlert as O,Icon as T,ProductItemCard as x,PriceRange as I,Image as Z}from"@dropins/tools/components.js";/* empty css                 */import{s as W,c as q,a as F,S as G,P as J}from"../chunks/acdlEvents.js";import{useText as K}from"@dropins/tools/i18n.js";const R=a=>new DOMParser().parseFromString(a,"text/html").documentElement.textContent,C=({productList:a,imageWidth:m,imageHeight:n})=>r("div",{className:"product-discovery-product-list",style:{"--imageWidth":m,"--imageHeight":n},children:r("div",{className:"product-discovery-product-list__grid",children:a&&r(j,{node:a})})}),Q=a=>s.createElement("svg",{id:"Icon_Warning_Base",width:24,height:24,viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg",...a},s.createElement("g",{clipPath:"url(#clip0_841_1324)"},s.createElement("path",{vectorEffect:"non-scaling-stroke",d:"M11.9949 2.30237L0.802734 21.6977H23.1977L11.9949 2.30237Z",stroke:"currentColor",strokeLinecap:"round",strokeLinejoin:"round"}),s.createElement("path",{vectorEffect:"non-scaling-stroke",d:"M12.4336 10.5504L12.3373 14.4766H11.6632L11.5669 10.5504V9.51273H12.4336V10.5504ZM11.5883 18.2636V17.2687H12.4229V18.2636H11.5883Z",stroke:"currentColor",strokeLinecap:"round",strokeLinejoin:"round"})),s.createElement("defs",null,s.createElement("clipPath",{id:"clip0_841_1324"},s.createElement("rect",{width:24,height:21,fill:"white",transform:"translate(0 1.5)"})))),X=({alertMessage:a=""})=>r("div",{className:B(["product-discovery-search-alert-message__wrapper"]),children:r("div",{className:"product-discovery-search-alert-message__content",children:r(O,{heading:a,type:"warning",icon:r(T,{source:Q,size:"24"}),onDismiss:void 0})})}),le=({routeProduct:a,scope:m,slots:n,imageWidth:h=400,imageHeight:P=450,skeletonCount:L=8})=>{const p=m==="popover"?G:J,k=K({noResults:"Search.PLP.Warning.noResults",searchError:"Search.PLP.Warning.searchError"}),[N,E]=S([]),[A,V]=S(!1),[f,w]=S(null);b(()=>{const e=_.on("search/loading",V,{eager:!0,scope:m}),t=_.on("search/error",()=>{w(k.searchError)},{eager:!0,scope:m}),c=_.on("search/result",i=>{var o,l;w(((o=i.result)==null?void 0:o.items.length)<1?k.noResults:null),E((l=i.result)==null?void 0:l.items),i.request.phrase?W(p):q(p)},{eager:!0,scope:m});return()=>{e==null||e.off(),t==null||t.off(),c==null||c.off()}},[]);const v=e=>{F(e.sku,p)},D=(e,t)=>{var l,u,d,y;const c={loading:t<8?"eager":"lazy",src:((u=(l=e.images)==null?void 0:l[0])==null?void 0:u.url)||"",alt:((y=(d=e.images)==null?void 0:d[0])==null?void 0:y.label)||"",width:h,height:P,params:{width:h}},i=e.name!==null?R(e.name):e.sku,o=r(Z,{class:"product-discovery-product-item__image",...c,"aria-label":i});return r(g,{name:"ProductImage",slot:n==null?void 0:n.ProductImage,context:{product:e,defaultImageProps:c},children:a?r("a",{href:a(e),onClick:()=>v(e),children:o}):o})},M=e=>{const t=e.name!==null?R(e.name):"";return r(g,{name:"ProductName",slot:n==null?void 0:n.ProductName,context:{product:e},children:a?r("a",{href:a(e),onClick:()=>v(e),children:t}):t})},H=e=>{var i,o,l,u,d;let t=e.typename==="ComplexProductView"?(i=e.priceRange)==null?void 0:i.minimum.regular.amount.currency:(o=e.price)==null?void 0:o.regular.amount.currency;Intl.supportedValuesOf("currency").indexOf(t||"")===-1&&(t="USD");const c=e.typename==="ComplexProductView"?r(I,{display:"from to",minimumAmount:(l=e.priceRange)==null?void 0:l.minimum.regular.amount.value,maximumAmount:(u=e.priceRange)==null?void 0:u.maximum.regular.amount.value,currency:t}):r(I,{amount:(d=e.price)==null?void 0:d.regular.amount.value,currency:t});return r(g,{name:"ProductPrice",slot:n==null?void 0:n.ProductPrice,context:{product:e},children:a?r("a",{href:a(e),onClick:()=>v(e),children:c}):c})},z=e=>r(g,{name:"ProductActions",slot:n==null?void 0:n.ProductActions,context:{product:e}}),U=()=>r(g,{name:"NoResults",slot:n==null?void 0:n.NoResults,context:{error:f},children:f&&r(X,{alertMessage:f})});return r("div",{children:A?r(C,{imageWidth:h,imageHeight:P,productList:Array.from({length:L}).map((e,t)=>r(x,{initialized:!1},t))}):f?U():r(C,{imageWidth:h,imageHeight:P,productList:N.map((e,t)=>r(x,{image:D(e,t),titleNode:M(e),price:H(e),actionButton:n!=null&&n.ProductActions?z(e):void 0,initialized:!0},e.id||e.sku||t))})})};export{le as SearchResults,le as default};
//# sourceMappingURL=SearchResults.js.map
