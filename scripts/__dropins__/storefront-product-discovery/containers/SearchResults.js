/*! Copyright 2025 Adobe
All Rights Reserved. */
import{jsxs as Z,jsx as n}from"@dropins/tools/preact-jsx-runtime.js";import*as d from"@dropins/tools/preact-compat.js";import{useState as v,useEffect as q}from"@dropins/tools/preact-compat.js";import{VComponent as W,classes as G,Slot as g}from"@dropins/tools/lib.js";import{events as y}from"@dropins/tools/event-bus.js";import{InLineAlert as J,Icon as K,ProductItemCard as L,PriceRange as S,Image as Q}from"@dropins/tools/components.js";/* empty css                 */import{s as X,c as Y,a as $,S as ee,P as re}from"../chunks/acdlEvents.js";import{useText as ne}from"@dropins/tools/i18n.js";const E=a=>new DOMParser().parseFromString(a,"text/html").documentElement.textContent,R=({productList:a,header:o,footer:r,imageWidth:h,imageHeight:f})=>Z("div",{className:"product-discovery-product-list",style:{"--imageWidth":h,"--imageHeight":f},children:[o&&n("div",{className:"product-discovery-product-list__header",children:o}),n("div",{className:"product-discovery-product-list__grid",children:a&&n(W,{node:a})}),r&&n("div",{className:"product-discovery-product-list__footer",children:r})]}),te=a=>d.createElement("svg",{id:"Icon_Warning_Base",width:24,height:24,viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg",...a},d.createElement("g",{clipPath:"url(#clip0_841_1324)"},d.createElement("path",{vectorEffect:"non-scaling-stroke",d:"M11.9949 2.30237L0.802734 21.6977H23.1977L11.9949 2.30237Z",stroke:"currentColor",strokeLinecap:"round",strokeLinejoin:"round"}),d.createElement("path",{vectorEffect:"non-scaling-stroke",d:"M12.4336 10.5504L12.3373 14.4766H11.6632L11.5669 10.5504V9.51273H12.4336V10.5504ZM11.5883 18.2636V17.2687H12.4229V18.2636H11.5883Z",stroke:"currentColor",strokeLinecap:"round",strokeLinejoin:"round"})),d.createElement("defs",null,d.createElement("clipPath",{id:"clip0_841_1324"},d.createElement("rect",{width:24,height:21,fill:"white",transform:"translate(0 1.5)"})))),ae=({alertMessage:a=""})=>n("div",{className:G(["product-discovery-search-alert-message__wrapper"]),children:n("div",{className:"product-discovery-search-alert-message__content",children:n(J,{heading:a,type:"warning",icon:n(K,{source:te,size:"24"}),onDismiss:void 0})})}),he=({routeProduct:a,scope:o,slots:r,imageWidth:h=400,imageHeight:f=450,skeletonCount:A=8,onSearchResult:_})=>{const x=o==="popover"?ee:re,I=ne({noResults:"Search.PLP.Warning.noResults",searchError:"Search.PLP.Warning.searchError"}),[u,V]=v(null),[k,H]=v([]),[D,M]=v(!1),[P,N]=v(null);q(()=>{const e=y.on("search/loading",M,{eager:!0,scope:o}),t=y.on("search/error",()=>{N(I.searchError)},{eager:!0,scope:o}),i=y.on("search/result",c=>{var m,s,l;N(((m=c.result)==null?void 0:m.items.length)<1?I.noResults:null),V(c.request),H((s=c.result)==null?void 0:s.items),_==null||_((l=c.result)==null?void 0:l.items),c.request.phrase?X(x):Y(x)},{eager:!0,scope:o});return()=>{e==null||e.off(),t==null||t.off(),i==null||i.off()}},[]);const w=e=>{$(e.sku,x)},b=(e,t)=>{var s,l,p,C;const i={loading:t<8?"eager":"lazy",src:((l=(s=e.images)==null?void 0:s[0])==null?void 0:l.url)||"",alt:((C=(p=e.images)==null?void 0:p[0])==null?void 0:C.label)||"",width:h,height:f,params:{width:h}},c=e.name!==null?E(e.name):e.sku,m=n(Q,{class:"product-discovery-product-item__image",...i,"aria-label":c});return n(g,{name:"ProductImage",slot:r==null?void 0:r.ProductImage,context:{product:e,defaultImageProps:i,variables:u},children:a?n("a",{href:a(e),onClick:()=>w(e),children:m}):m})},j=e=>{const t=e.name!==null?E(e.name):"";return n(g,{name:"ProductName",slot:r==null?void 0:r.ProductName,context:{product:e,variables:u},children:a?n("a",{href:a(e),onClick:()=>w(e),children:t}):t})},z=e=>{var c,m,s,l,p;let t=e.typename==="ComplexProductView"?(c=e.priceRange)==null?void 0:c.minimum.regular.amount.currency:(m=e.price)==null?void 0:m.regular.amount.currency;Intl.supportedValuesOf("currency").indexOf(t||"")===-1&&(t="USD");const i=e.typename==="ComplexProductView"?n(S,{display:"from to",minimumAmount:(s=e.priceRange)==null?void 0:s.minimum.regular.amount.value,maximumAmount:(l=e.priceRange)==null?void 0:l.maximum.regular.amount.value,currency:t}):n(S,{amount:(p=e.price)==null?void 0:p.regular.amount.value,currency:t});return n(g,{name:"ProductPrice",slot:r==null?void 0:r.ProductPrice,context:{product:e,variables:u},children:a?n("a",{href:a(e),onClick:()=>w(e),children:i}):i})},F=e=>n(g,{name:"ProductActions",slot:r==null?void 0:r.ProductActions,context:{product:e,variables:u}}),U=()=>n(g,{name:"NoResults",slot:r==null?void 0:r.NoResults,context:{error:P,variables:u},children:P&&n(ae,{alertMessage:P})}),B=()=>n(R,{imageWidth:h,imageHeight:f,productList:Array.from({length:A}).map((e,t)=>n(L,{initialized:!1},t))}),O=()=>n(g,{name:"Header",slot:r==null?void 0:r.Header,context:{products:k,variables:u}}),T=()=>n(g,{name:"Footer",slot:r==null?void 0:r.Footer,context:{products:k,variables:u}});return n("div",{children:D?B():P?U():n(R,{header:O(),footer:T(),imageWidth:h,imageHeight:f,productList:k.map((e,t)=>n(L,{image:b(e,t),titleNode:j(e),price:z(e),actionButton:r!=null&&r.ProductActions?F(e):void 0,initialized:!0},e.id||e.sku||t))})})};export{he as SearchResults,he as default};
//# sourceMappingURL=SearchResults.js.map
