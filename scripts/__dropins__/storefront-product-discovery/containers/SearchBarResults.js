/*! Copyright 2025 Adobe
All Rights Reserved. */
import{jsx as r,jsxs as _}from"@dropins/tools/preact-jsx-runtime.js";import{useRef as $,useCallback as N,useEffect as E,useMemo as q,useState as g}from"@dropins/tools/preact-compat.js";import{Button as C,Price as K,Image as O}from"@dropins/tools/components.js";import{VComponent as v,Slot as y}from"@dropins/tools/lib.js";import{events as P}from"@dropins/tools/event-bus.js";/* empty css                   */import{s as Q,S as U}from"../chunks/acdlEvents.js";import{useText as H}from"@dropins/tools/i18n.js";const M=({productList:i,viewAllButton:l,onClose:n,...a})=>{const t=i&&i.length>0,o=$(null),s=N(c=>{o.current&&!o.current.contains(c.target)&&(n==null||n())},[n]),u=N(c=>{c.key==="Escape"&&(n==null||n())},[n]);return E(()=>{if(t)return document.addEventListener("mousedown",s),document.addEventListener("keydown",u),()=>{document.removeEventListener("mousedown",s),document.removeEventListener("keydown",u)}},[t,s,u]),t?r("div",{className:"product-discovery--search-bar-results",...a,children:r("div",{className:"product-discovery--search-bar-results__popover",ref:o,role:"region","aria-label":"Search results","aria-live":"polite",children:_("div",{className:"product-discovery--search-bar-results__outer-container",...a,children:[r("div",{className:"product-discovery--search-bar-results__grid",role:"list","aria-label":`${(i==null?void 0:i.length)||0} search results`,children:i==null?void 0:i.map((c,h)=>r("div",{role:"listitem",children:c},h))}),l&&r("div",{className:"product-discovery--search-bar-results__view-all-wrapper",children:r(v,{className:"product-discovery--search-bar-results__view-all-button",node:l})})]})})}):null},V=({productRouteSearch:i=s=>(s==null?void 0:s.url)||"",productItem:l,productImage:n,productName:a,productPrice:t,...o})=>{const s=q(()=>{const{name:c="",sku:h="",url:f=""}=l||{};return{tooltipText:[c,h&&`SKU: ${h}`].filter(Boolean).join(`
`),url:f}},[l]),u=c=>{Q(c.sku,U)};return _("a",{className:"product-discovery--product-item",href:i(l),target:"_blank",rel:"noopener noreferrer",title:s.tooltipText,onClick:()=>u(l),...o,children:[r("div",{className:"product-discovery--product-item__image",children:r(v,{node:n})}),_("div",{className:"product-discovery--product-item__details",children:[r(v,{node:a}),r(v,{node:t})]})]})},I=({products:i=[],productRouteSearch:l=t=>(t==null?void 0:t.url)||"",routeSearch:n=()=>{},slots:a})=>{const[t,o]=g(i),[s,u]=g(""),[c,h]=g(i.length>0),f=H({viewAllButton:"Search.SearchInput.viewAllButton"});E(()=>{const e=P.on("search-input/result",w);return()=>{e==null||e.off()}},[]);const w=({result:e=[],request:d={}})=>{const{phrase:m=""}=d;o(e),u(m),h(e.length>0&&m.length>0)},b=N(()=>{n&&n(s),P.emit("search/request",{phrase:s}),P.emit("search-input/result",{result:[],request:{phrase:""}}),h(!1)},[n,s]),A=e=>{var d,m;return r(y,{name:"ProductImage",slot:a==null?void 0:a.ProductImage,context:{productItem:e},children:r(O,{src:((m=(d=e==null?void 0:e.images)==null?void 0:d[0])==null?void 0:m.url)||""})})},T=e=>r(y,{name:"ProductName",slot:a==null?void 0:a.ProductName,context:{productItem:e},children:(e==null?void 0:e.name)||""}),p=e=>{var k,S,R,x,B;const{value:d,currency:m}=((S=(k=e==null?void 0:e.price)==null?void 0:k.final)==null?void 0:S.amount)||((B=(x=(R=e==null?void 0:e.priceRange)==null?void 0:R.minimum)==null?void 0:x.final)==null?void 0:B.amount)||{};return r(y,{name:"ProductPrice",slot:a==null?void 0:a.ProductPrice,context:{productItem:e},children:r(K,{amount:typeof d=="number"?d:void 0,currency:m})})},j=e=>r(V,{productRouteSearch:l,productItem:e,productImage:A(e),productName:T(e),productPrice:p(e)}),D=()=>r(C,{variant:"tertiary",onClick:()=>{b()},children:f.viewAllButton});return r("div",{children:t.length>0&&c&&r(M,{productList:t==null?void 0:t.map(e=>j(e)),viewAllButton:D(),onClose:b})})};export{I as SearchBarResults,I as default};
//# sourceMappingURL=SearchBarResults.js.map
