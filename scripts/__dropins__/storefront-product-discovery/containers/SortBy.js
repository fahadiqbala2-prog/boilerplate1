/*! Copyright 2025 Adobe
All Rights Reserved. */
import{jsx as d}from"@dropins/tools/preact-jsx-runtime.js";import{useState as i,useEffect as g}from"@dropins/tools/preact-compat.js";import{Picker as x}from"@dropins/tools/components.js";import{events as O}from"@dropins/tools/event-bus.js";import{d as h}from"../chunks/search.js";import{useText as q}from"@dropins/tools/i18n.js";import"@dropins/tools/lib.js";import"../fragments.js";import"../chunks/acdlEvents.js";import"@dropins/tools/fetch-graphql.js";const B=({scope:t,onSortChange:e})=>{const n=q({sortLabel:"Search.PLP.SortDropdown.title"}),[c,l]=i([]),[f,m]=i("relevance_DESC"),[S,b]=i({});g(()=>{const r=O.on("search/result",s=>{var o,u;if(b(s.request),(u=(o=s.result)==null?void 0:o.metadata)!=null&&u.sortableAttributes&&(l([...s.result.metadata.sortableAttributes]),s.request.sort)){const a=D(s.request.sort);a&&m(a)}},{eager:!0,scope:t});return()=>{r==null||r.off()}},[]);const p=async r=>{e==null||e(r[0]),h({...S,sort:r,currentPage:1},{scope:t})};return d(x,{required:!0,floatingLabel:n.sortLabel,...A(c),value:f,handleSelect:r=>{const{value:s}=r.target,o=C(s);p(o)}})};function A(t){return{options:t.map(n=>({text:n.label,value:`${n.attribute}_DESC`}))}}function C(t){const e=t.indexOf("_");return[{attribute:t.substring(0,e),direction:t.substring(e+1)==="ASC"?"ASC":"DESC"}]}function D(t){return t.length>0&&t[0]?`${t[0].attribute}_${t[0].direction}`:""}export{B as SortBy,B as default};
//# sourceMappingURL=SortBy.js.map
